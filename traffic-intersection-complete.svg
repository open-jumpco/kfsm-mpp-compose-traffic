<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1035px" preserveAspectRatio="none" style="width:1490px;height:1035px;background:#FFFFFF;" version="1.1" viewBox="0 0 1490 1035" width="1490px" zoomAndPan="magnify"><defs><filter height="300%" id="f2lcqn4nqwjyf" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><!--MD5=[c317431f81cdf0e8053db5837ef6c822]
class TrafficLightStates--><rect codeLine="2" fill="#FEFECE" filter="url(#f2lcqn4nqwjyf)" height="97.6953" id="TrafficLightStates" style="stroke:#A80036;stroke-width:1.5;" width="127" x="1185" y="895.5"/><ellipse cx="1200" cy="915.5938" fill="#EB937F" rx="11" ry="11" style="stroke:#A80036;stroke-width:1.0;"/><path d="M1198.5,916.5938 L1198.5,918.5938 L1202.5,918.5938 L1202.5,917.5938 L1202.5,917.1094 L1203.125,916.5938 L1203.5,916.5938 L1203.875,916.5938 L1204.5,917.1094 L1204.5,917.5938 L1204.5,920.5938 L1196.5,920.5938 L1196.0156,920.5938 L1195.5,919.9688 L1195.5,919.5938 L1195.5,919.2188 L1196.0156,918.5938 L1196.5,918.5938 L1196.5,918.5938 L1196.5,912.5938 L1196.5,912.5938 L1196.0156,912.5938 L1195.5,911.9688 L1195.5,911.5938 L1195.5,911.2188 L1196.0156,910.5938 L1196.5,910.5938 L1204.5,910.5938 L1204.5,913.5938 L1204.5,914.0781 L1203.875,914.5938 L1203.5,914.5938 L1203.125,914.5938 L1202.5,914.0781 L1202.5,913.5938 L1202.5,912.5938 L1198.5,912.5938 L1198.5,914.5938 L1199.5,914.5938 L1199.5,914.1094 L1199.5,914.1094 L1200.125,913.5938 L1200.5,913.5938 L1200.875,913.5938 L1201.5,914.1094 L1201.5,914.5938 L1201.5,916.5938 L1201.5,917.0781 L1200.875,917.5938 L1200.875,917.5938 L1200.5,917.5938 L1200.125,917.5938 L1199.5,917.0781 L1199.5,917.0781 L1199.5,916.5938 L1198.5,916.5938 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="64" x="1229.5" y="912.957">«fsm-state»</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="95" x="1214" y="928.0508">TrafficLightStates</text><line style="stroke:#A80036;stroke-width:1.5;" x1="1186" x2="1311" y1="935.6875" y2="935.6875"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="20" x="1191" y="951.1064">RED</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="36" x="1191" y="964.9424">AMBER</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="34" x="1191" y="978.7783">GREEN</text><line style="stroke:#A80036;stroke-width:1.5;" x1="1186" x2="1311" y1="985.1953" y2="985.1953"/><!--MD5=[082ea4b1b4c949e9e678c41ae71c099b]
class TrafficLightEvents--><rect codeLine="8" fill="#FEFECE" filter="url(#f2lcqn4nqwjyf)" height="83.8594" id="TrafficLightEvents" style="stroke:#A80036;stroke-width:1.5;" width="129" x="1347" y="902.5"/><ellipse cx="1362" cy="922.5938" fill="#EB937F" rx="11" ry="11" style="stroke:#A80036;stroke-width:1.0;"/><path d="M1360.5,923.5938 L1360.5,925.5938 L1364.5,925.5938 L1364.5,924.5938 L1364.5,924.1094 L1365.125,923.5938 L1365.5,923.5938 L1365.875,923.5938 L1366.5,924.1094 L1366.5,924.5938 L1366.5,927.5938 L1358.5,927.5938 L1358.0156,927.5938 L1357.5,926.9688 L1357.5,926.5938 L1357.5,926.2188 L1358.0156,925.5938 L1358.5,925.5938 L1358.5,925.5938 L1358.5,919.5938 L1358.5,919.5938 L1358.0156,919.5938 L1357.5,918.9688 L1357.5,918.5938 L1357.5,918.2188 L1358.0156,917.5938 L1358.5,917.5938 L1366.5,917.5938 L1366.5,920.5938 L1366.5,921.0781 L1365.875,921.5938 L1365.5,921.5938 L1365.125,921.5938 L1364.5,921.0781 L1364.5,920.5938 L1364.5,919.5938 L1360.5,919.5938 L1360.5,921.5938 L1361.5,921.5938 L1361.5,921.1094 L1361.5,921.1094 L1362.125,920.5938 L1362.5,920.5938 L1362.875,920.5938 L1363.5,921.1094 L1363.5,921.5938 L1363.5,923.5938 L1363.5,924.0781 L1362.875,924.5938 L1362.875,924.5938 L1362.5,924.5938 L1362.125,924.5938 L1361.5,924.0781 L1361.5,924.0781 L1361.5,923.5938 L1360.5,923.5938 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="68" x="1390.5" y="919.957">«fsm-event»</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="97" x="1376" y="935.0508">TrafficLightEvents</text><line style="stroke:#A80036;stroke-width:1.5;" x1="1348" x2="1475" y1="942.6875" y2="942.6875"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="27" x="1353" y="958.1064">STOP</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="16" x="1353" y="971.9424">GO</text><line style="stroke:#A80036;stroke-width:1.5;" x1="1348" x2="1475" y1="978.3594" y2="978.3594"/><!--MD5=[a261c3b0f6dc39c3323e9647de972898]
class TrafficLightContext--><rect codeLine="12" fill="#FEFECE" filter="url(#f2lcqn4nqwjyf)" height="153.0391" id="TrafficLightContext" style="stroke:#A80036;stroke-width:1.5;" width="270" x="879.5" y="868"/><ellipse cx="959.25" cy="888.0938" fill="#B4A7E5" rx="11" ry="11" style="stroke:#A80036;stroke-width:1.0;"/><path d="M960.25,885.0938 L960.25,891.0938 L962.25,891.0938 L962.7344,891.0938 L963.25,891.7188 L963.25,892.0938 L963.25,892.4688 L962.7344,893.0938 L962.25,893.0938 L956.25,893.0938 L955.7656,893.0938 L955.25,892.4688 L955.25,892.0938 L955.25,891.7188 L955.7656,891.0938 L956.25,891.0938 L958.25,891.0938 L958.25,885.0938 L956.25,885.0938 L955.7656,885.0938 L955.25,884.4688 L955.25,884.0938 L955.25,883.7188 L955.7656,883.0938 L956.25,883.0938 L962.25,883.0938 L962.7344,883.0938 L963.25,883.7188 L963.25,884.0938 L963.25,884.4688 L962.7344,885.0938 L962.25,885.0938 L960.25,885.0938 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="77" x="992.25" y="885.457">«fsm-context»</text><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="102" x="979.75" y="900.5508">TrafficLightContext</text><line style="stroke:#A80036;stroke-width:1.5;" x1="880.5" x2="1148.5" y1="908.1875" y2="908.1875"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="60" x="885.5" y="923.6064">name: String</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="97" x="885.5" y="937.4424">amberTimeout: Long</text><line style="stroke:#A80036;stroke-width:1.5;" x1="880.5" x2="1148.5" y1="943.8594" y2="943.8594"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="120" x="885.5" y="959.2783">setStopped() «suspend»</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="174" x="885.5" y="973.1143">switchRed(on: Boolean) «suspend»</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="187" x="885.5" y="986.9502">switchAmber(on: Boolean) «suspend»</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="185" x="885.5" y="1000.7861">switchGreen(on: Boolean) «suspend»</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="258" x="885.5" y="1014.6221">stateChanged(toState: TrafficLightStates) «suspend»</text><!--MD5=[d85e1abf3caa9c226551ac440a773ac6]
class TrafficLightController--><rect codeLine="22" fill="#FEFECE" filter="url(#f2lcqn4nqwjyf)" height="131.0156" id="TrafficLightController" style="stroke:#A80036;stroke-width:1.5;" width="189" x="655" y="879"/><ellipse cx="689.35" cy="895" fill="#B4A7E5" rx="11" ry="11" style="stroke:#A80036;stroke-width:1.0;"/><path d="M690.35,892 L690.35,898 L692.35,898 L692.8344,898 L693.35,898.625 L693.35,899 L693.35,899.375 L692.8344,900 L692.35,900 L686.35,900 L685.8656,900 L685.35,899.375 L685.35,899 L685.35,898.625 L685.8656,898 L686.35,898 L688.35,898 L688.35,892 L686.35,892 L685.8656,892 L685.35,891.375 L685.35,891 L685.35,890.625 L685.8656,890 L686.35,890 L692.35,890 L692.8344,890 L693.35,890.625 L693.35,891 L693.35,891.375 L692.8344,892 L692.35,892 L690.35,892 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="114" x="707.65" y="899.9102">TrafficLightController</text><line style="stroke:#A80036;stroke-width:1.5;" x1="656" x2="843" y1="911" y2="911"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="136" x="661" y="926.4189">amber: StateFlow&lt;Boolean&gt;</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="122" x="661" y="940.2549">red: StateFlow&lt;Boolean&gt;</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="134" x="661" y="954.0908">green: StateFlow&lt;Boolean&gt;</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="140" x="661" y="967.9268">stopped: SharedFlow&lt;Long&gt;</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="177" x="661" y="981.7627">state: StateFlow&lt;TrafficLightStates&gt;</text><line style="stroke:#A80036;stroke-width:1.5;" x1="656" x2="843" y1="988.1797" y2="988.1797"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="169" x="661" y="1003.5986">changeAmberTimeout(value: Long)</text><!--MD5=[8f5d905706df63f012d7d74357fff60c]
class TrafficLightFSM--><rect codeLine="32" fill="#FEFECE" filter="url(#f2lcqn4nqwjyf)" height="83.8594" id="TrafficLightFSM" style="stroke:#A80036;stroke-width:1.5;" width="118" x="1139.5" y="599.5"/><ellipse cx="1155.4" cy="619.5938" fill="#ADD1B2" rx="11" ry="11" style="stroke:#A80036;stroke-width:1.0;"/><path d="M1157.4,616.0938 Q1157.6031,615.5938 1157.8375,615.3438 Q1158.0719,615.0938 1158.3375,615.0938 Q1158.8063,615.0938 1159.1031,615.375 Q1159.4,615.6563 1159.4,616.3125 L1159.4,617.875 Q1159.4,618.5313 1159.1188,618.8125 Q1158.8375,619.0938 1158.4,619.0938 Q1158.0094,619.0938 1157.7594,618.9219 Q1157.5094,618.75 1157.4,618.2969 Q1157.3531,617.9844 1157.1813,617.8125 Q1156.8688,617.4844 1156.3063,617.2969 Q1155.7438,617.0938 1155.1813,617.0938 Q1154.4781,617.0938 1153.8844,617.375 Q1153.3063,617.6563 1152.8531,618.2813 Q1152.4,618.9063 1152.4,619.7656 L1152.4,620.6875 Q1152.4,621.7188 1153.2438,622.4063 Q1154.0875,623.0938 1155.5875,623.0938 Q1156.4781,623.0938 1157.1031,622.8906 Q1157.4625,622.7813 1157.8688,622.4219 Q1158.1344,622.2188 1158.275,622.1563 Q1158.4156,622.0938 1158.5875,622.0938 Q1158.9156,622.0938 1159.15,622.3594 Q1159.4,622.6094 1159.4,622.9688 Q1159.4,623.3125 1159.0563,623.7188 Q1158.5563,624.3125 1157.7594,624.6406 Q1156.7125,625.0938 1155.4313,625.0938 Q1153.9313,625.0938 1152.7281,624.5 Q1151.7594,624.0313 1151.0719,623.0156 Q1150.4,622 1150.4,620.7969 L1150.4,619.7031 Q1150.4,618.4531 1150.9938,617.3594 Q1151.6031,616.2656 1152.65,615.6875 Q1153.7125,615.0938 1154.9,615.0938 Q1155.6188,615.0938 1156.2438,615.3438 Q1156.8688,615.5938 1157.4,616.0938 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="34" x="1194.6" y="616.957">«fsm»</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="84" x="1169.6" y="632.0508">TrafficLightFSM</text><line style="stroke:#A80036;stroke-width:1.5;" x1="1140.5" x2="1256.5" y1="639.6875" y2="639.6875"/><line style="stroke:#A80036;stroke-width:1.5;" x1="1140.5" x2="1256.5" y1="647.6875" y2="647.6875"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="106" x="1145.5" y="663.1064">fun start() «suspend»</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="105" x="1145.5" y="676.9424">fun stop() «suspend»</text><!--MD5=[24d80c7a7824efcf0b8bd16fe5b50cae]
class TrafficLightService--><rect codeLine="41" fill="#FEFECE" filter="url(#f2lcqn4nqwjyf)" height="249.8906" id="TrafficLightService" style="stroke:#A80036;stroke-width:1.5;" width="270" x="936.5" y="86"/><ellipse cx="997.75" cy="106.0938" fill="#ADD1B2" rx="11" ry="11" style="stroke:#A80036;stroke-width:1.0;"/><path d="M999.75,102.5938 Q999.9531,102.0938 1000.1875,101.8438 Q1000.4219,101.5938 1000.6875,101.5938 Q1001.1563,101.5938 1001.4531,101.875 Q1001.75,102.1563 1001.75,102.8125 L1001.75,104.375 Q1001.75,105.0313 1001.4688,105.3125 Q1001.1875,105.5938 1000.75,105.5938 Q1000.3594,105.5938 1000.1094,105.4219 Q999.8594,105.25 999.75,104.7969 Q999.7031,104.4844 999.5313,104.3125 Q999.2188,103.9844 998.6563,103.7969 Q998.0938,103.5938 997.5313,103.5938 Q996.8281,103.5938 996.2344,103.875 Q995.6563,104.1563 995.2031,104.7813 Q994.75,105.4063 994.75,106.2656 L994.75,107.1875 Q994.75,108.2188 995.5938,108.9063 Q996.4375,109.5938 997.9375,109.5938 Q998.8281,109.5938 999.4531,109.3906 Q999.8125,109.2813 1000.2188,108.9219 Q1000.4844,108.7188 1000.625,108.6563 Q1000.7656,108.5938 1000.9375,108.5938 Q1001.2656,108.5938 1001.5,108.8594 Q1001.75,109.1094 1001.75,109.4688 Q1001.75,109.8125 1001.4063,110.2188 Q1000.9063,110.8125 1000.1094,111.1406 Q999.0625,111.5938 997.7813,111.5938 Q996.2813,111.5938 995.0781,111 Q994.1094,110.5313 993.4219,109.5156 Q992.75,108.5 992.75,107.2969 L992.75,106.2031 Q992.75,104.9531 993.3438,103.8594 Q993.9531,102.7656 995,102.1875 Q996.0625,101.5938 997.25,101.5938 Q997.9688,101.5938 998.5938,101.8438 Q999.2188,102.0938 999.75,102.5938 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="143" x="1016.25" y="103.457">«context-implementation»</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="100" x="1037.75" y="118.5508">TrafficLightService</text><line style="stroke:#A80036;stroke-width:1.5;" x1="937.5" x2="1205.5" y1="126.1875" y2="126.1875"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="60" x="942.5" y="141.6064">name: String</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="97" x="942.5" y="155.4424">amberTimeout: Long</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="136" x="942.5" y="169.2783">amber: StateFlow&lt;Boolean&gt;</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="122" x="942.5" y="183.1143">red: StateFlow&lt;Boolean&gt;</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="134" x="942.5" y="196.9502">green: StateFlow&lt;Boolean&gt;</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="140" x="942.5" y="210.7861">stopped: SharedFlow&lt;Long&gt;</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="177" x="942.5" y="224.6221">state: StateFlow&lt;TrafficLightStates&gt;</text><line style="stroke:#A80036;stroke-width:1.5;" x1="937.5" x2="1205.5" y1="231.0391" y2="231.0391"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="169" x="942.5" y="246.458">changeAmberTimeout(value: Long)</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="0" x="945.5" y="260.2939"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="120" x="942.5" y="274.1299">setStopped() «suspend»</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="174" x="942.5" y="287.9658">switchRed(on: Boolean) «suspend»</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="187" x="942.5" y="301.8018">switchAmber(on: Boolean) «suspend»</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="185" x="942.5" y="315.6377">switchGreen(on: Boolean) «suspend»</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="258" x="942.5" y="329.4736">stateChanged(toState: TrafficLightStates) «suspend»</text><!--MD5=[9749051c974da246c300c6b23f53e7a6]
class IntersectionStates--><rect codeLine="62" fill="#FEFECE" filter="url(#f2lcqn4nqwjyf)" height="111.5313" id="IntersectionStates" style="stroke:#A80036;stroke-width:1.5;" width="131" x="7" y="888.5"/><ellipse cx="22" cy="908.5938" fill="#EB937F" rx="11" ry="11" style="stroke:#A80036;stroke-width:1.0;"/><path d="M20.5,909.5938 L20.5,911.5938 L24.5,911.5938 L24.5,910.5938 L24.5,910.1094 L25.125,909.5938 L25.5,909.5938 L25.875,909.5938 L26.5,910.1094 L26.5,910.5938 L26.5,913.5938 L18.5,913.5938 L18.0156,913.5938 L17.5,912.9688 L17.5,912.5938 L17.5,912.2188 L18.0156,911.5938 L18.5,911.5938 L18.5,911.5938 L18.5,905.5938 L18.5,905.5938 L18.0156,905.5938 L17.5,904.9688 L17.5,904.5938 L17.5,904.2188 L18.0156,903.5938 L18.5,903.5938 L26.5,903.5938 L26.5,906.5938 L26.5,907.0781 L25.875,907.5938 L25.5,907.5938 L25.125,907.5938 L24.5,907.0781 L24.5,906.5938 L24.5,905.5938 L20.5,905.5938 L20.5,907.5938 L21.5,907.5938 L21.5,907.1094 L21.5,907.1094 L22.125,906.5938 L22.5,906.5938 L22.875,906.5938 L23.5,907.1094 L23.5,907.5938 L23.5,909.5938 L23.5,910.0781 L22.875,910.5938 L22.875,910.5938 L22.5,910.5938 L22.125,910.5938 L21.5,910.0781 L21.5,910.0781 L21.5,909.5938 L20.5,909.5938 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="64" x="53.5" y="905.957">«fsm-state»</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="99" x="36" y="921.0508">IntersectionStates</text><line style="stroke:#A80036;stroke-width:1.5;" x1="8" x2="137" y1="928.6875" y2="928.6875"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="50" x="13" y="944.1064">STOPPING</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="43" x="13" y="957.9424">WAITING</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="33" x="13" y="971.7783">GOING</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="46" x="13" y="985.6143">STOPPED</text><line style="stroke:#A80036;stroke-width:1.5;" x1="8" x2="137" y1="992.0313" y2="992.0313"/><!--MD5=[335fb609bd3f47ab478c9b95fb231727]
class IntersectionEvents--><rect codeLine="69" fill="#FEFECE" filter="url(#f2lcqn4nqwjyf)" height="111.5313" id="IntersectionEvents" style="stroke:#A80036;stroke-width:1.5;" width="133" x="173" y="888.5"/><ellipse cx="188" cy="908.5938" fill="#EB937F" rx="11" ry="11" style="stroke:#A80036;stroke-width:1.0;"/><path d="M186.5,909.5938 L186.5,911.5938 L190.5,911.5938 L190.5,910.5938 L190.5,910.1094 L191.125,909.5938 L191.5,909.5938 L191.875,909.5938 L192.5,910.1094 L192.5,910.5938 L192.5,913.5938 L184.5,913.5938 L184.0156,913.5938 L183.5,912.9688 L183.5,912.5938 L183.5,912.2188 L184.0156,911.5938 L184.5,911.5938 L184.5,911.5938 L184.5,905.5938 L184.5,905.5938 L184.0156,905.5938 L183.5,904.9688 L183.5,904.5938 L183.5,904.2188 L184.0156,903.5938 L184.5,903.5938 L192.5,903.5938 L192.5,906.5938 L192.5,907.0781 L191.875,907.5938 L191.5,907.5938 L191.125,907.5938 L190.5,907.0781 L190.5,906.5938 L190.5,905.5938 L186.5,905.5938 L186.5,907.5938 L187.5,907.5938 L187.5,907.1094 L187.5,907.1094 L188.125,906.5938 L188.5,906.5938 L188.875,906.5938 L189.5,907.1094 L189.5,907.5938 L189.5,909.5938 L189.5,910.0781 L188.875,910.5938 L188.875,910.5938 L188.5,910.5938 L188.125,910.5938 L187.5,910.0781 L187.5,910.0781 L187.5,909.5938 L186.5,909.5938 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="68" x="218.5" y="905.957">«fsm-event»</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="101" x="202" y="921.0508">IntersectionEvents</text><line style="stroke:#A80036;stroke-width:1.5;" x1="174" x2="305" y1="928.6875" y2="928.6875"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="42" x="179" y="944.1064">SWITCH,</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="49" x="179" y="957.9424">STOPPED,</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="30" x="179" y="971.7783">STOP,</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="34" x="179" y="985.6143">START</text><line style="stroke:#A80036;stroke-width:1.5;" x1="174" x2="305" y1="992.0313" y2="992.0313"/><!--MD5=[9868cacd5d1749ce2e997e727c15cdbd]
class TrafficIntersectionContext--><rect codeLine="76" fill="#FEFECE" filter="url(#f2lcqn4nqwjyf)" height="153.0391" id="TrafficIntersectionContext" style="stroke:#A80036;stroke-width:1.5;" width="278" x="341.5" y="868"/><ellipse cx="406.75" cy="888.0938" fill="#B4A7E5" rx="11" ry="11" style="stroke:#A80036;stroke-width:1.0;"/><path d="M407.75,885.0938 L407.75,891.0938 L409.75,891.0938 L410.2344,891.0938 L410.75,891.7188 L410.75,892.0938 L410.75,892.4688 L410.2344,893.0938 L409.75,893.0938 L403.75,893.0938 L403.2656,893.0938 L402.75,892.4688 L402.75,892.0938 L402.75,891.7188 L403.2656,891.0938 L403.75,891.0938 L405.75,891.0938 L405.75,885.0938 L403.75,885.0938 L403.2656,885.0938 L402.75,884.4688 L402.75,884.0938 L402.75,883.7188 L403.2656,883.0938 L403.75,883.0938 L409.75,883.0938 L410.2344,883.0938 L410.75,883.7188 L410.75,884.0938 L410.75,884.4688 L410.2344,885.0938 L409.75,885.0938 L407.75,885.0938 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="77" x="458.25" y="885.457">«fsm-context»</text><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="139" x="427.25" y="900.5508">TrafficIntersectionContext</text><line style="stroke:#A80036;stroke-width:1.5;" x1="342.5" x2="618.5" y1="908.1875" y2="908.1875"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="95" x="347.5" y="923.6064">val cycleTime: Long</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="116" x="347.5" y="937.4424">val cycleWaitTime: Long</text><line style="stroke:#A80036;stroke-width:1.5;" x1="342.5" x2="618.5" y1="943.8594" y2="943.8594"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="266" x="347.5" y="959.2783">suspend fun stateChanged(toState: IntersectionStates)</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="151" x="347.5" y="973.1143">suspend fun start() «suspend»</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="150" x="347.5" y="986.9502">suspend fun stop() «suspend»</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="150" x="347.5" y="1000.7861">suspend fun next() «suspend»</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="143" x="347.5" y="1014.6221">suspend fun off() «suspend»</text><!--MD5=[c56cb48cb5367e6a067e96aa34014d4b]
class TrafficIntersectionFSM--><rect codeLine="86" fill="#FEFECE" filter="url(#f2lcqn4nqwjyf)" height="139.2031" id="TrafficIntersectionFSM" style="stroke:#A80036;stroke-width:1.5;" width="214" x="140.5" y="572"/><ellipse cx="182.95" cy="592.0938" fill="#ADD1B2" rx="11" ry="11" style="stroke:#A80036;stroke-width:1.0;"/><path d="M184.95,588.5938 Q185.1531,588.0938 185.3875,587.8438 Q185.6219,587.5938 185.8875,587.5938 Q186.3563,587.5938 186.6531,587.875 Q186.95,588.1563 186.95,588.8125 L186.95,590.375 Q186.95,591.0313 186.6688,591.3125 Q186.3875,591.5938 185.95,591.5938 Q185.5594,591.5938 185.3094,591.4219 Q185.0594,591.25 184.95,590.7969 Q184.9031,590.4844 184.7313,590.3125 Q184.4188,589.9844 183.8563,589.7969 Q183.2938,589.5938 182.7313,589.5938 Q182.0281,589.5938 181.4344,589.875 Q180.8563,590.1563 180.4031,590.7813 Q179.95,591.4063 179.95,592.2656 L179.95,593.1875 Q179.95,594.2188 180.7938,594.9063 Q181.6375,595.5938 183.1375,595.5938 Q184.0281,595.5938 184.6531,595.3906 Q185.0125,595.2813 185.4188,594.9219 Q185.6844,594.7188 185.825,594.6563 Q185.9656,594.5938 186.1375,594.5938 Q186.4656,594.5938 186.7,594.8594 Q186.95,595.1094 186.95,595.4688 Q186.95,595.8125 186.6063,596.2188 Q186.1063,596.8125 185.3094,597.1406 Q184.2625,597.5938 182.9813,597.5938 Q181.4813,597.5938 180.2781,597 Q179.3094,596.5313 178.6219,595.5156 Q177.95,594.5 177.95,593.2969 L177.95,592.2031 Q177.95,590.9531 178.5438,589.8594 Q179.1531,588.7656 180.2,588.1875 Q181.2625,587.5938 182.45,587.5938 Q183.1688,587.5938 183.7938,587.8438 Q184.4188,588.0938 184.95,588.5938 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="34" x="246.55" y="589.457">«fsm»</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="121" x="203.05" y="604.5508">TrafficIntersectionFSM</text><line style="stroke:#A80036;stroke-width:1.5;" x1="141.5" x2="353.5" y1="612.1875" y2="612.1875"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="153" x="146.5" y="627.6064">currentState: IntersectionStates</text><line style="stroke:#A80036;stroke-width:1.5;" x1="141.5" x2="353.5" y1="634.0234" y2="634.0234"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="202" x="146.5" y="649.4424">allowedEvents(): Set&lt;IntersectionEvents&gt;</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="143" x="146.5" y="663.2783">startIntersection() «suspend»</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="142" x="146.5" y="677.1143">stopIntersection() «suspend»</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="154" x="146.5" y="690.9502">switchIntersection() «suspend»</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="104" x="146.5" y="704.7861">stopped() «suspend»</text><!--MD5=[67a963a920e61d5a3e163bee231ae3ae]
class TrafficIntersectionController--><rect codeLine="99" fill="#FEFECE" filter="url(#f2lcqn4nqwjyf)" height="297.0469" id="TrafficIntersectionController" style="stroke:#A80036;stroke-width:1.5;" width="318" x="590.5" y="493"/><ellipse cx="669.75" cy="509" fill="#B4A7E5" rx="11" ry="11" style="stroke:#A80036;stroke-width:1.0;"/><path d="M670.75,506 L670.75,512 L672.75,512 L673.2344,512 L673.75,512.625 L673.75,513 L673.75,513.375 L673.2344,514 L672.75,514 L666.75,514 L666.2656,514 L665.75,513.375 L665.75,513 L665.75,512.625 L666.2656,512 L666.75,512 L668.75,512 L668.75,506 L666.75,506 L666.2656,506 L665.75,505.375 L665.75,505 L665.75,504.625 L666.2656,504 L666.75,504 L672.75,504 L673.2344,504 L673.75,504.625 L673.75,505 L673.75,505.375 L673.2344,506 L672.75,506 L670.75,506 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="151" x="690.25" y="513.9102">TrafficIntersectionController</text><line style="stroke:#A80036;stroke-width:1.5;" x1="591.5" x2="907.5" y1="525" y2="525"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="97" x="596.5" y="540.4189">amberTimeout: Long</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="178" x="596.5" y="554.2549">state: StateFlow&lt;IntersectionStates&gt;</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="140" x="596.5" y="568.0908">stopped: SharedFlow&lt;Long&gt;</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="96" x="596.5" y="581.9268">currentName: String</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="133" x="596.5" y="595.7627">current: TrafficLightContext</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="104" x="596.5" y="609.5986">listOrder: List&lt;String&gt;</text><line style="stroke:#A80036;stroke-width:1.5;" x1="591.5" x2="907.5" y1="616.0156" y2="616.0156"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="190" x="596.5" y="631.4346">get(name: String): TrafficLightController</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="149" x="596.5" y="645.2705">changeCycleTime(value: Long)</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="170" x="596.5" y="659.1064">changeCycleWaitTime(value: Long)</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="169" x="596.5" y="672.9424">changeAmberTimeout(value: Long)</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="306" x="596.5" y="686.7783">addTrafficLight(name: String, trafficLight: TrafficLightController)</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="202" x="596.5" y="700.6143">allowedEvents(): Set&lt;IntersectionEvents&gt;</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="91" x="596.5" y="714.4502">setupIntersection()</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="47" x="596.5" y="728.2861">stopped()</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="145" x="596.5" y="742.1221">startTrafficLight(name: String)</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="66" x="596.5" y="755.958">startSystem()</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="65" x="596.5" y="769.7939">stopSystem()</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="41" x="596.5" y="783.6299">switch()</text><!--MD5=[09381f51bdf889138526ece6de7cd791]
class TrafficIntersectionService--><rect codeLine="123" fill="#FEFECE" filter="url(#f2lcqn4nqwjyf)" height="407.7344" id="TrafficIntersectionService" style="stroke:#A80036;stroke-width:1.5;" width="318" x="268.5" y="7"/><ellipse cx="354.75" cy="23" fill="#ADD1B2" rx="11" ry="11" style="stroke:#A80036;stroke-width:1.0;"/><path d="M356.75,19.5 Q356.9531,19 357.1875,18.75 Q357.4219,18.5 357.6875,18.5 Q358.1563,18.5 358.4531,18.7813 Q358.75,19.0625 358.75,19.7188 L358.75,21.2813 Q358.75,21.9375 358.4688,22.2188 Q358.1875,22.5 357.75,22.5 Q357.3594,22.5 357.1094,22.3281 Q356.8594,22.1563 356.75,21.7031 Q356.7031,21.3906 356.5313,21.2188 Q356.2188,20.8906 355.6563,20.7031 Q355.0938,20.5 354.5313,20.5 Q353.8281,20.5 353.2344,20.7813 Q352.6563,21.0625 352.2031,21.6875 Q351.75,22.3125 351.75,23.1719 L351.75,24.0938 Q351.75,25.125 352.5938,25.8125 Q353.4375,26.5 354.9375,26.5 Q355.8281,26.5 356.4531,26.2969 Q356.8125,26.1875 357.2188,25.8281 Q357.4844,25.625 357.625,25.5625 Q357.7656,25.5 357.9375,25.5 Q358.2656,25.5 358.5,25.7656 Q358.75,26.0156 358.75,26.375 Q358.75,26.7188 358.4063,27.125 Q357.9063,27.7188 357.1094,28.0469 Q356.0625,28.5 354.7813,28.5 Q353.2813,28.5 352.0781,27.9063 Q351.1094,27.4375 350.4219,26.4219 Q349.75,25.4063 349.75,24.2031 L349.75,23.1094 Q349.75,21.8594 350.3438,20.7656 Q350.9531,19.6719 352,19.0938 Q353.0625,18.5 354.25,18.5 Q354.9688,18.5 355.5938,18.75 Q356.2188,19 356.75,19.5 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="137" x="375.25" y="27.9102">TrafficIntersectionService</text><line style="stroke:#A80036;stroke-width:1.5;" x1="269.5" x2="585.5" y1="39" y2="39"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="178" x="274.5" y="54.4189">state: StateFlow&lt;IntersectionStates&gt;</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="140" x="274.5" y="68.2549">stopped: SharedFlow&lt;Long&gt;</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="97" x="274.5" y="82.0908">amberTimeout: Long</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="104" x="274.5" y="95.9268">listOrder: List&lt;String&gt;</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="78" x="274.5" y="109.7627">cycleTime: Long</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="96" x="274.5" y="123.5986">currentName: String</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="133" x="274.5" y="137.4346">current: TrafficLightContext</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="99" x="274.5" y="151.2705">cycleWaitTime: Long</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="153" x="274.5" y="165.1064">currentState: IntersectionStates</text><line style="stroke:#A80036;stroke-width:1.5;" x1="269.5" x2="585.5" y1="171.5234" y2="171.5234"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="169" x="274.5" y="186.9424">changeAmberTimeout(value: Long)</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="91" x="274.5" y="200.7783">setupIntersection()</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="190" x="274.5" y="214.6143">get(name: String): TrafficLightController</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="306" x="274.5" y="228.4502">addTrafficLight(name: String, trafficLight: TrafficLightController)</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="145" x="274.5" y="242.2861">startTrafficLight(name: String)</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="202" x="274.5" y="256.1221">stateChanged(toState: IntersectionStates)</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="149" x="274.5" y="269.958">changeCycleTime(value: Long)</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="170" x="274.5" y="283.7939">changeCycleWaitTime(value: Long)</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="30" x="274.5" y="297.6299">start()</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="29" x="274.5" y="311.4658">stop()</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="22" x="274.5" y="325.3018">off()</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="29" x="274.5" y="339.1377">next()</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="66" x="274.5" y="352.9736">startSystem()</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="65" x="274.5" y="366.8096">stopSystem()</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="41" x="274.5" y="380.6455">switch()</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="47" x="274.5" y="394.4814">stopped()</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="202" x="274.5" y="408.3174">allowedEvents(): Set&lt;IntersectionEvents&gt;</text><!--MD5=[ce902affe73128e0a9c1460ddb6351ac]
class TrafficIntersectionViewModel--><rect codeLine="156" fill="#90EE90" filter="url(#f2lcqn4nqwjyf)" height="249.8906" id="TrafficIntersectionViewModel" style="stroke:#A80036;stroke-width:1.5;" width="264" x="621.5" y="86"/><ellipse cx="671.25" cy="106.0938" fill="#ADD1B2" rx="11" ry="11" style="stroke:#A80036;stroke-width:1.0;"/><path d="M673.25,102.5938 Q673.4531,102.0938 673.6875,101.8438 Q673.9219,101.5938 674.1875,101.5938 Q674.6563,101.5938 674.9531,101.875 Q675.25,102.1563 675.25,102.8125 L675.25,104.375 Q675.25,105.0313 674.9688,105.3125 Q674.6875,105.5938 674.25,105.5938 Q673.8594,105.5938 673.6094,105.4219 Q673.3594,105.25 673.25,104.7969 Q673.2031,104.4844 673.0313,104.3125 Q672.7188,103.9844 672.1563,103.7969 Q671.5938,103.5938 671.0313,103.5938 Q670.3281,103.5938 669.7344,103.875 Q669.1563,104.1563 668.7031,104.7813 Q668.25,105.4063 668.25,106.2656 L668.25,107.1875 Q668.25,108.2188 669.0938,108.9063 Q669.9375,109.5938 671.4375,109.5938 Q672.3281,109.5938 672.9531,109.3906 Q673.3125,109.2813 673.7188,108.9219 Q673.9844,108.7188 674.125,108.6563 Q674.2656,108.5938 674.4375,108.5938 Q674.7656,108.5938 675,108.8594 Q675.25,109.1094 675.25,109.4688 Q675.25,109.8125 674.9063,110.2188 Q674.4063,110.8125 673.6094,111.1406 Q672.5625,111.5938 671.2813,111.5938 Q669.7813,111.5938 668.5781,111 Q667.6094,110.5313 666.9219,109.5156 Q666.25,108.5 666.25,107.2969 L666.25,106.2031 Q666.25,104.9531 666.8438,103.8594 Q667.4531,102.7656 668.5,102.1875 Q669.5625,101.5938 670.75,101.5938 Q671.4688,101.5938 672.0938,101.8438 Q672.7188,102.0938 673.25,102.5938 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="73" x="733.25" y="103.457">«viewmodel»</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="156" x="691.75" y="118.5508">TrafficIntersectionViewModel</text><line style="stroke:#A80036;stroke-width:1.5;" x1="622.5" x2="884.5" y1="126.1875" y2="126.1875"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="114" x="627.5" y="141.6064">val amberTimeout: Long</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="116" x="627.5" y="155.4424">val cycleWaitTime: Long</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="95" x="627.5" y="169.2783">val cycleTime: Long</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="113" x="627.5" y="183.1143">val currentName: String</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="211" x="627.5" y="196.9502">val trafficLights: List&lt;TrafficLightController&gt;</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="0" x="630.5" y="210.7861"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="252" x="627.5" y="224.6221">val intersectionState: StateFlow&lt;IntersectionStates&gt;</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="172" x="627.5" y="238.458">val allowStart: StateFlow&lt;Boolean&gt;</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="183" x="627.5" y="252.2939">val allowSwitch: StateFlow&lt;Boolean&gt;</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="171" x="627.5" y="266.1299">val allowStop: StateFlow&lt;Boolean&gt;</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="211" x="627.5" y="279.9658">val trafficLights: List&lt;TrafficLightController&gt;</text><line style="stroke:#A80036;stroke-width:1.5;" x1="622.5" x2="884.5" y1="286.3828" y2="286.3828"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="123" x="627.5" y="301.8018">startSystem() «suspend»</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="122" x="627.5" y="315.6377">stopSystem() «suspend»</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="98" x="627.5" y="329.4736">switch() «suspend»</text><!--MD5=[e90295f2306cf9f2d48d2dd155fc66d8]
link TrafficLightController to TrafficLightContext--><path codeLine="30" d="M844.217,944.5 C849.266,944.5 854.316,944.5 859.365,944.5 " fill="none" id="TrafficLightController-to-TrafficLightContext" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="none" points="859.471,937.4999,879.471,944.5,859.471,951.4999,859.471,937.4999" style="stroke:#A80036;stroke-width:1.0;"/><!--MD5=[f5a4d25a21e2db1a9bef5b5bdfa80daf]
link TrafficLightFSM to TrafficLightStates--><path codeLine="37" d="M1205.35,683.722 C1214.25,737.33 1229.82,831.072 1239.63,890.08 " fill="none" id="TrafficLightFSM-to-TrafficLightStates" style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="#A80036" points="1240.5,895.326,1242.9687,885.7916,1239.6794,890.3938,1235.0772,887.1045,1240.5,895.326" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="42" x="1232.5" y="834.4951">«uses»</text><!--MD5=[ef55fa34c35daebc710b7e66915eb99f]
link TrafficLightFSM to TrafficLightEvents--><path codeLine="38" d="M1227.67,683.722 C1267.39,739.854 1338.25,839.991 1379.43,898.179 " fill="none" id="TrafficLightFSM-to-TrafficLightEvents" style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="#A80036" points="1382.34,902.294,1380.4106,892.636,1379.4536,898.2113,1373.8782,897.2543,1382.34,902.294" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="42" x="1338.5" y="834.4951">«uses»</text><!--MD5=[7d975c74983153482517d07fdba291a6]
link TrafficLightFSM to TrafficLightContext--><path codeLine="39" d="M1173.3,683.722 C1145.15,729.778 1098.89,805.457 1063.54,863.284 " fill="none" id="TrafficLightFSM-to-TrafficLightContext" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="1060.8,867.766,1068.9045,862.1699,1063.406,863.4988,1062.077,858.0003,1060.8,867.766" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="43" x="1086.5" y="834.4951">context</text><!--MD5=[a14a1606ab3e0ad97f005eafd1d1dbee]
link TrafficLightService to TrafficLightController--><path codeLine="58" d="M1061.75,336.208 C1047.34,459.261 1011.92,649.197 925.5,790 C908.287,818.043 884.3,843.732 859.564,865.742 " fill="none" id="TrafficLightService-to-TrafficLightController" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="none" points="863.866,871.274,844.119,878.959,854.763,860.637,863.866,871.274" style="stroke:#A80036;stroke-width:1.0;"/><!--MD5=[b02eea57f08a8734f953d301797f548e]
link TrafficLightService to TrafficLightFSM--><path codeLine="59" d="M1111.7283,347.7338 C1111.7283,347.7338 1164.98,527.414 1182.56,586.722 " fill="none" id="TrafficLightService-TrafficLightFSM" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="1186.35,599.496,1187.6291,589.7306,1184.9299,594.7019,1179.9585,592.0027,1186.35,599.496" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1184.9299" x2="1182.655" y1="594.7019" y2="587.031"/><polygon fill="#A80036" points="1108.32,336.228,1106.1889,343.117,1111.7283,347.7338,1113.8594,340.8448,1108.32,336.228" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="21" x="1144.5" y="459.4951">fsm</text><!--MD5=[02c58767cbaebf5fe961d047052ec028]
link TrafficIntersectionFSM to TrafficIntersectionContext--><path codeLine="95" d="M280.587,711.081 C301.116,750.232 329.616,799.107 361.5,838 C368.775,846.874 376.825,855.648 385.205,864.12 " fill="none" id="TrafficIntersectionFSM-to-TrafficIntersectionContext" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="388.816,867.732,385.2823,858.5389,385.2812,864.1958,379.6243,864.1946,388.816,867.732" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="43" x="362.5" y="834.4951">context</text><!--MD5=[9468340d7453291c53dc9c139c20e995]
link TrafficIntersectionFSM to IntersectionEvents--><path codeLine="96" d="M241.264,711.212 C238.463,748.666 235.901,795.851 236.5,838 C236.708,852.604 237.077,868.342 237.487,883.092 " fill="none" id="TrafficIntersectionFSM-to-IntersectionEvents" style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="#A80036" points="237.639,888.478,241.3829,879.3685,237.4976,883.48,233.3861,879.5947,237.639,888.478" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="83" x="237.5" y="834.4951">events «uses»</text><!--MD5=[fe4ec4b482b722450bc85149b58e4a7c]
link TrafficIntersectionFSM to IntersectionStates--><path codeLine="97" d="M207.571,711.178 C177.313,763.222 136.151,834.021 107.245,883.739 " fill="none" id="TrafficIntersectionFSM-to-IntersectionStates" style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="#A80036" points="104.6618,888.182,112.643,882.4113,107.1746,883.8593,105.7266,878.3909,104.6618,888.182" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="82" x="140.5" y="834.4951">states «uses»</text><!--MD5=[f99ab679abda8f782610770a06d7759b]
link TrafficIntersectionController to TrafficIntersectionContext--><path codeLine="120" d="M617.364,790.355 C598.294,811.693 579.16,833.103 561.497,852.867 " fill="none" id="TrafficIntersectionController-to-TrafficIntersectionContext" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="none" points="566.537,857.732,547.991,867.981,556.099,848.403,566.537,857.732" style="stroke:#A80036;stroke-width:1.0;"/><!--MD5=[623b43cb3e72afdaaab4b9f9f3b9f428]
link TrafficIntersectionController to TrafficLightController--><path codeLine="121" d="M749.5,802.355 C749.5,802.355 749.5,846.268 749.5,865.463 " fill="none" id="TrafficIntersectionController-TrafficLightController" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="749.5,878.724,753.5,869.724,749.5,873.724,745.5,869.724,749.5,878.724" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="749.5" x2="749.5" y1="873.724" y2="865.724"/><polygon fill="#A80036" points="749.5,790.355,745.5,796.355,749.5,802.355,753.5,796.355,749.5,790.355" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="66" x="750.5" y="834.4951">trafficLights</text><!--MD5=[213e98c6e1b68eaf0278262acaf92988]
link TrafficIntersectionService to TrafficIntersectionController--><path codeLine="152" d="M580.249,415.27 C595.755,435.905 611.364,456.676 626.498,476.815 " fill="none" id="TrafficIntersectionService-to-TrafficIntersectionController" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="none" points="632.103,472.622,638.522,492.816,620.911,481.033,632.103,472.622" style="stroke:#A80036;stroke-width:1.0;"/><!--MD5=[a0c4c6e1b7e6bd88c7aa08379bf65076]
link TrafficIntersectionService to TrafficIntersectionFSM--><path codeLine="153" d="M263.4713,422.3847 C263.4713,422.3847 257.036,437.766 254.5,445 C241.945,480.808 239.015,522.598 239.701,558.328 " fill="none" id="TrafficIntersectionService-TrafficIntersectionFSM" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="240.128,571.7,243.8382,562.5767,239.9681,566.7026,235.8423,562.8325,240.128,571.7" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="239.9681" x2="239.713" y1="566.7026" y2="558.7065"/><polygon fill="#A80036" points="268.467,411.474,262.3322,415.2641,263.4713,422.3847,269.606,418.5946,268.467,411.474" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="150" x="255.5" y="459.4951">intersectionFSM «private»</text><!--MD5=[5a10fe9a7b46e29ac4c7cf70982de1b2]
link TrafficIntersectionService to TrafficLightController--><path codeLine="154" d="M412.1755,427.2036 C412.1755,427.2036 409.765,732.762 449.5,790 C500.854,863.973 557.134,825.453 636.5,868 C639.077,869.381 641.668,870.806 644.268,872.266 " fill="none" id="TrafficIntersectionService-TrafficLightController" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="655.693,878.874,649.9046,870.9057,651.3647,876.3709,645.8995,877.831,655.693,878.874" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="651.3647" x2="644.44" y1="876.3709" y2="872.365"/><polygon fill="#A80036" points="412.674,415.214,408.4282,421.0427,412.1755,427.2036,416.4213,421.375,412.674,415.214" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="121" x="450.5" y="646.9951">trafficLights «private»</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="22" x="627.6866" y="868.9186">1..n</text><!--MD5=[a0825e187c969bcbe7623a28eff8e879]
link TrafficIntersectionViewModel to TrafficIntersectionController--><path codeLine="174" d="M752.34,336.228 C751.899,383.536 751.39,438.002 750.927,487.66 " fill="none" id="TrafficIntersectionViewModel-to-TrafficIntersectionController" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="750.879,492.759,754.9637,483.7971,750.9261,487.7592,746.964,483.7217,750.879,492.759" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="98" x="752.5" y="459.4951">trafficIntersection</text><!--MD5=[fd0dfe321ae00ad6f58b71386f1a92b6]
@startuml

enum TrafficLightStates <<fsm-state>> {
    RED
    AMBER
    GREEN
}

enum TrafficLightEvents <<fsm-event>> {
    STOP
    GO
}
interface TrafficLightContext <<fsm-context>> {
    name: String
    amberTimeout: Long
    setStopped() <<suspend>>
    switchRed(on: Boolean) <<suspend>>
    switchAmber(on: Boolean) <<suspend>>
    switchGreen(on: Boolean) <<suspend>>
    stateChanged(toState: TrafficLightStates) <<suspend>>
}

interface TrafficLightController {
    amber: StateFlow<Boolean>
    red: StateFlow<Boolean>
    green: StateFlow<Boolean>
    stopped: SharedFlow<Long>
    state: StateFlow<TrafficLightStates>
    changeAmberTimeout(value: Long)
}
TrafficLightController -|> TrafficLightContext

class TrafficLightFSM <<fsm>> {
    fun start() <<suspend>>
    fun stop() <<suspend>>
}

TrafficLightFSM ..> TrafficLightStates: <<uses>>
TrafficLightFSM ..> TrafficLightEvents: <<uses>>
TrafficLightFSM - -> TrafficLightContext: context

class TrafficLightService <<context-implementation>> {
    name: String
    amberTimeout: Long
    amber: StateFlow<Boolean>
    red: StateFlow<Boolean>
    green: StateFlow<Boolean>
    stopped: SharedFlow<Long>
    state: StateFlow<TrafficLightStates>
    changeAmberTimeout(value: Long)

    setStopped() <<suspend>>
    switchRed(on: Boolean) <<suspend>>
    switchAmber(on: Boolean) <<suspend>>
    switchGreen(on: Boolean) <<suspend>>
    stateChanged(toState: TrafficLightStates) <<suspend>>
}

TrafficLightService - -|> TrafficLightController
TrafficLightService *- -> TrafficLightFSM: fsm


enum IntersectionStates <<fsm-state>> {
    STOPPING
    WAITING
    GOING
    STOPPED
}

enum IntersectionEvents <<fsm-event>> {
    SWITCH,
    STOPPED,
    STOP,
    START
}

interface TrafficIntersectionContext <<fsm-context>> {
    val cycleTime: Long
    val cycleWaitTime: Long
    suspend fun stateChanged(toState: IntersectionStates)
    suspend fun start() <<suspend>>
    suspend fun stop() <<suspend>>
    suspend fun next() <<suspend>>
    suspend fun off() <<suspend>>
}

class TrafficIntersectionFSM <<fsm>> {
    currentState: IntersectionStates
    allowedEvents(): Set<IntersectionEvents>
    startIntersection() <<suspend>>
    stopIntersection() <<suspend>>
    switchIntersection() <<suspend>>
    stopped() <<suspend>>
}

TrafficIntersectionFSM - -> TrafficIntersectionContext: context
TrafficIntersectionFSM ..> IntersectionEvents: events <<uses>>
TrafficIntersectionFSM ..> IntersectionStates: states <<uses>>

interface TrafficIntersectionController {
    amberTimeout: Long
    state: StateFlow<IntersectionStates>
    stopped: SharedFlow<Long>
    currentName: String
    current: TrafficLightContext
    listOrder: List<String>
    get(name: String): TrafficLightController
    changeCycleTime(value: Long)
    changeCycleWaitTime(value: Long)
    changeAmberTimeout(value: Long)
    addTrafficLight(name: String, trafficLight: TrafficLightController)
    allowedEvents(): Set<IntersectionEvents>
    setupIntersection()
    stopped()
    startTrafficLight(name: String)
    startSystem()
    stopSystem()
    switch()
}

TrafficIntersectionController -|> TrafficIntersectionContext
TrafficIntersectionController *- -> TrafficLightController: trafficLights

class TrafficIntersectionService {
    state: StateFlow<IntersectionStates>
    stopped: SharedFlow<Long>
    amberTimeout: Long
    changeAmberTimeout(value: Long)
    setupIntersection()
    listOrder: List<String>
    cycleTime: Long
        currentName: String
        current: TrafficLightContext
        cycleWaitTime: Long
        currentState: IntersectionStates
    get(name: String): TrafficLightController
    addTrafficLight(name: String, trafficLight: TrafficLightController)
    startTrafficLight(name: String)
    stateChanged(toState: IntersectionStates)
    changeCycleTime(value: Long)
    changeCycleWaitTime(value: Long)
    start()
    stop()
    off()
    next()
    startSystem()
    stopSystem()
    switch()
    stopped()
    allowedEvents(): Set<IntersectionEvents>
}

TrafficIntersectionService - -|> TrafficIntersectionController
TrafficIntersectionService *- -> TrafficIntersectionFSM: intersectionFSM <<private>>
TrafficIntersectionService *- -> "1..n" TrafficLightController: trafficLights <<private>>

class TrafficIntersectionViewModel <<viewmodel>> #lightgreen {
    val amberTimeout: Long
    val cycleWaitTime: Long
    val cycleTime: Long
    val currentName: String
    val trafficLights: List<TrafficLightController>

    val intersectionState: StateFlow<IntersectionStates>
    val allowStart: StateFlow<Boolean>
    val allowSwitch: StateFlow<Boolean>
    val allowStop: StateFlow<Boolean>
    val trafficLights: List<TrafficLightController>

    startSystem() <<suspend>>
    stopSystem() <<suspend>>
    switch() <<suspend>>
}

TrafficIntersectionViewModel - -> TrafficIntersectionController: trafficIntersection

@enduml

PlantUML version 1.2021.7(Sun May 23 14:40:07 CAT 2021)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: Cp1252
Language: en
Country: ZA
--></g></svg>