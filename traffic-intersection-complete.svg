<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="695.6px" preserveAspectRatio="none" style="width:479px;height:695px;background:#FFFFFF;" version="1.1" viewBox="0 0 479 695" width="479.2px" zoomAndPan="magnify"><defs><filter height="300%" id="fiai61dau77o4" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="0.8000000000000002"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="1.6000000000000003" dy="1.6000000000000003" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><!--MD5=[c317431f81cdf0e8053db5837ef6c822]
class TrafficLightStates--><rect codeLine="2" fill="#FEFECE" filter="url(#fiai61dau77o4)" height="39.0781" id="TrafficLightStates" style="stroke:#A80036;stroke-width:0.6000000000000001;" width="50.8" x="2.8" y="639.8"/><ellipse cx="8.8" cy="647.8375" fill="#EB937F" rx="4.4" ry="4.4" style="stroke:#A80036;stroke-width:0.4000000000000001;"/><path d="M8.2,648.2375 L8.2,649.0375 L9.8,649.0375 L9.8,648.6375 L9.8,648.4438 L10.05,648.2375 L10.2,648.2375 L10.35,648.2375 L10.6,648.4438 L10.6,648.6375 L10.6,649.8375 L7.4,649.8375 L7.2063,649.8375 L7,649.5875 L7,649.4375 L7,649.2875 L7.2063,649.0375 L7.4,649.0375 L7.4,649.0375 L7.4,646.6375 L7.4,646.6375 L7.2063,646.6375 L7,646.3875 L7,646.2375 L7,646.0875 L7.2063,645.8375 L7.4,645.8375 L10.6,645.8375 L10.6,647.0375 L10.6,647.2313 L10.35,647.4375 L10.2,647.4375 L10.05,647.4375 L9.8,647.2313 L9.8,647.0375 L9.8,646.6375 L8.2,646.6375 L8.2,647.4375 L8.6,647.4375 L8.6,647.2438 L8.6,647.2438 L8.85,647.0375 L9,647.0375 L9.15,647.0375 L9.4,647.2438 L9.4,647.4375 L9.4,648.2375 L9.4,648.4313 L9.15,648.6375 L9.15,648.6375 L9,648.6375 L8.85,648.6375 L8.6,648.4313 L8.6,648.4313 L8.6,648.2375 L8.2,648.2375 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="4.8" font-style="italic" lengthAdjust="spacing" textLength="25.6" x="20.6" y="646.7828">«fsm-state»</text><text fill="#000000" font-family="sans-serif" font-size="4.8" lengthAdjust="spacing" textLength="38" x="14.4" y="652.8203">TrafficLightStates</text><line style="stroke:#A80036;stroke-width:0.6000000000000001;" x1="3.2" x2="53.2" y1="655.875" y2="655.875"/><text fill="#000000" font-family="sans-serif" font-size="4.4" lengthAdjust="spacing" textLength="8" x="5.2" y="662.0426">RED</text><text fill="#000000" font-family="sans-serif" font-size="4.4" lengthAdjust="spacing" textLength="14.4" x="5.2" y="667.577">AMBER</text><text fill="#000000" font-family="sans-serif" font-size="4.4" lengthAdjust="spacing" textLength="13.6" x="5.2" y="673.1113">GREEN</text><line style="stroke:#A80036;stroke-width:0.6000000000000001;" x1="3.2" x2="53.2" y1="675.6781" y2="675.6781"/><!--MD5=[082ea4b1b4c949e9e678c41ae71c099b]
class TrafficLightEvents--><rect codeLine="8" fill="#FEFECE" filter="url(#fiai61dau77o4)" height="33.5438" id="TrafficLightEvents" style="stroke:#A80036;stroke-width:0.6000000000000001;" width="51.6" x="67.6" y="642.6"/><ellipse cx="73.6" cy="650.6375" fill="#EB937F" rx="4.4" ry="4.4" style="stroke:#A80036;stroke-width:0.4000000000000001;"/><path d="M73,651.0375 L73,651.8375 L74.6,651.8375 L74.6,651.4375 L74.6,651.2438 L74.85,651.0375 L75,651.0375 L75.15,651.0375 L75.4,651.2438 L75.4,651.4375 L75.4,652.6375 L72.2,652.6375 L72.0063,652.6375 L71.8,652.3875 L71.8,652.2375 L71.8,652.0875 L72.0063,651.8375 L72.2,651.8375 L72.2,651.8375 L72.2,649.4375 L72.2,649.4375 L72.0063,649.4375 L71.8,649.1875 L71.8,649.0375 L71.8,648.8875 L72.0063,648.6375 L72.2,648.6375 L75.4,648.6375 L75.4,649.8375 L75.4,650.0313 L75.15,650.2375 L75,650.2375 L74.85,650.2375 L74.6,650.0313 L74.6,649.8375 L74.6,649.4375 L73,649.4375 L73,650.2375 L73.4,650.2375 L73.4,650.0438 L73.4,650.0438 L73.65,649.8375 L73.8,649.8375 L73.95,649.8375 L74.2,650.0438 L74.2,650.2375 L74.2,651.0375 L74.2,651.2313 L73.95,651.4375 L73.95,651.4375 L73.8,651.4375 L73.65,651.4375 L73.4,651.2313 L73.4,651.2313 L73.4,651.0375 L73,651.0375 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="4.8" font-style="italic" lengthAdjust="spacing" textLength="27.2" x="85" y="649.5828">«fsm-event»</text><text fill="#000000" font-family="sans-serif" font-size="4.8" lengthAdjust="spacing" textLength="38.8" x="79.2" y="655.6203">TrafficLightEvents</text><line style="stroke:#A80036;stroke-width:0.6000000000000001;" x1="68" x2="118.8" y1="658.675" y2="658.675"/><text fill="#000000" font-family="sans-serif" font-size="4.4" lengthAdjust="spacing" textLength="10.8" x="70" y="664.8426">STOP</text><text fill="#000000" font-family="sans-serif" font-size="4.4" lengthAdjust="spacing" textLength="6.4" x="70" y="670.377">GO</text><line style="stroke:#A80036;stroke-width:0.6000000000000001;" x1="68" x2="118.8" y1="672.9438" y2="672.9438"/><!--MD5=[a261c3b0f6dc39c3323e9647de972898]
class TrafficLightContext--><rect codeLine="12" fill="#FEFECE" filter="url(#fiai61dau77o4)" height="61.2156" id="TrafficLightContext" style="stroke:#A80036;stroke-width:0.6000000000000001;" width="108" x="133.4" y="628.8"/><ellipse cx="165.3" cy="636.8375" fill="#B4A7E5" rx="4.4" ry="4.4" style="stroke:#A80036;stroke-width:0.4000000000000001;"/><path d="M165.7,635.6375 L165.7,638.0375 L166.5,638.0375 L166.6938,638.0375 L166.9,638.2875 L166.9,638.4375 L166.9,638.5875 L166.6938,638.8375 L166.5,638.8375 L164.1,638.8375 L163.9063,638.8375 L163.7,638.5875 L163.7,638.4375 L163.7,638.2875 L163.9063,638.0375 L164.1,638.0375 L164.9,638.0375 L164.9,635.6375 L164.1,635.6375 L163.9063,635.6375 L163.7,635.3875 L163.7,635.2375 L163.7,635.0875 L163.9063,634.8375 L164.1,634.8375 L166.5,634.8375 L166.6938,634.8375 L166.9,635.0875 L166.9,635.2375 L166.9,635.3875 L166.6938,635.6375 L166.5,635.6375 L165.7,635.6375 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="4.8" font-style="italic" lengthAdjust="spacing" textLength="30.8" x="178.5" y="635.7828">«fsm-context»</text><text fill="#000000" font-family="sans-serif" font-size="4.8" font-style="italic" lengthAdjust="spacing" textLength="40.8" x="173.5" y="641.8203">TrafficLightContext</text><line style="stroke:#A80036;stroke-width:0.6000000000000001;" x1="133.8" x2="241" y1="644.875" y2="644.875"/><text fill="#000000" font-family="sans-serif" font-size="4.4" lengthAdjust="spacing" textLength="24" x="135.8" y="651.0426">name: String</text><text fill="#000000" font-family="sans-serif" font-size="4.4" lengthAdjust="spacing" textLength="38.8" x="135.8" y="656.577">amberTimeout: Long</text><line style="stroke:#A80036;stroke-width:0.6000000000000001;" x1="133.8" x2="241" y1="659.1438" y2="659.1438"/><text fill="#000000" font-family="sans-serif" font-size="4.4" lengthAdjust="spacing" textLength="48" x="135.8" y="665.3113">setStopped() «suspend»</text><text fill="#000000" font-family="sans-serif" font-size="4.4" lengthAdjust="spacing" textLength="69.6" x="135.8" y="670.8457">switchRed(on: Boolean) «suspend»</text><text fill="#000000" font-family="sans-serif" font-size="4.4" lengthAdjust="spacing" textLength="74.8" x="135.8" y="676.3801">switchAmber(on: Boolean) «suspend»</text><text fill="#000000" font-family="sans-serif" font-size="4.4" lengthAdjust="spacing" textLength="74" x="135.8" y="681.9145">switchGreen(on: Boolean) «suspend»</text><text fill="#000000" font-family="sans-serif" font-size="4.4" lengthAdjust="spacing" textLength="103.2" x="135.8" y="687.4488">stateChanged(toState: TrafficLightStates) «suspend»</text><!--MD5=[d85e1abf3caa9c226551ac440a773ac6]
class TrafficLightController--><rect codeLine="22" fill="#FEFECE" filter="url(#fiai61dau77o4)" height="52.4063" id="TrafficLightController" style="stroke:#A80036;stroke-width:0.6000000000000001;" width="75.6" x="138.8" y="482.8"/><ellipse cx="152.54" cy="489.2" fill="#B4A7E5" rx="4.4" ry="4.4" style="stroke:#A80036;stroke-width:0.4000000000000001;"/><path d="M152.94,488 L152.94,490.4 L153.74,490.4 L153.9338,490.4 L154.14,490.65 L154.14,490.8 L154.14,490.95 L153.9338,491.2 L153.74,491.2 L151.34,491.2 L151.1463,491.2 L150.94,490.95 L150.94,490.8 L150.94,490.65 L151.1463,490.4 L151.34,490.4 L152.14,490.4 L152.14,488 L151.34,488 L151.1463,488 L150.94,487.75 L150.94,487.6 L150.94,487.45 L151.1463,487.2 L151.34,487.2 L153.74,487.2 L153.9338,487.2 L154.14,487.45 L154.14,487.6 L154.14,487.75 L153.9338,488 L153.74,488 L152.94,488 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="4.8" font-style="italic" lengthAdjust="spacing" textLength="45.6" x="159.86" y="491.1641">TrafficLightController</text><line style="stroke:#A80036;stroke-width:0.6000000000000001;" x1="139.2" x2="214" y1="495.6" y2="495.6"/><text fill="#000000" font-family="sans-serif" font-size="4.4" lengthAdjust="spacing" textLength="54.4" x="141.2" y="501.7676">amber: StateFlow&lt;Boolean&gt;</text><text fill="#000000" font-family="sans-serif" font-size="4.4" lengthAdjust="spacing" textLength="48.8" x="141.2" y="507.302">red: StateFlow&lt;Boolean&gt;</text><text fill="#000000" font-family="sans-serif" font-size="4.4" lengthAdjust="spacing" textLength="53.6" x="141.2" y="512.8363">green: StateFlow&lt;Boolean&gt;</text><text fill="#000000" font-family="sans-serif" font-size="4.4" lengthAdjust="spacing" textLength="56" x="141.2" y="518.3707">stopped: SharedFlow&lt;Long&gt;</text><text fill="#000000" font-family="sans-serif" font-size="4.4" lengthAdjust="spacing" textLength="70.8" x="141.2" y="523.9051">state: StateFlow&lt;TrafficLightStates&gt;</text><line style="stroke:#A80036;stroke-width:0.6000000000000001;" x1="139.2" x2="214" y1="526.4719" y2="526.4719"/><text fill="#000000" font-family="sans-serif" font-size="4.4" lengthAdjust="spacing" textLength="67.6" x="141.2" y="532.6395">changeAmberTimeout(value: Long)</text><!--MD5=[8f5d905706df63f012d7d74357fff60c]
class TrafficLightFSM--><rect codeLine="32" fill="#FEFECE" filter="url(#fiai61dau77o4)" height="33.5438" id="TrafficLightFSM" style="stroke:#A80036;stroke-width:0.6000000000000001;" width="47.2" x="71.8" y="564"/><ellipse cx="78.16" cy="572.0375" fill="#ADD1B2" rx="4.4" ry="4.4" style="stroke:#A80036;stroke-width:0.4000000000000001;"/><path d="M78.96,570.6375 Q79.0413,570.4375 79.135,570.3375 Q79.2288,570.2375 79.335,570.2375 Q79.5225,570.2375 79.6413,570.35 Q79.76,570.4625 79.76,570.725 L79.76,571.35 Q79.76,571.6125 79.6475,571.725 Q79.535,571.8375 79.36,571.8375 Q79.2038,571.8375 79.1038,571.7688 Q79.0038,571.7 78.96,571.5188 Q78.9413,571.3938 78.8725,571.325 Q78.7475,571.1938 78.5225,571.1188 Q78.2975,571.0375 78.0725,571.0375 Q77.7913,571.0375 77.5538,571.15 Q77.3225,571.2625 77.1413,571.5125 Q76.96,571.7625 76.96,572.1063 L76.96,572.475 Q76.96,572.8875 77.2975,573.1625 Q77.635,573.4375 78.235,573.4375 Q78.5913,573.4375 78.8413,573.3563 Q78.985,573.3125 79.1475,573.1688 Q79.2538,573.0875 79.31,573.0625 Q79.3663,573.0375 79.435,573.0375 Q79.5663,573.0375 79.66,573.1438 Q79.76,573.2438 79.76,573.3875 Q79.76,573.525 79.6225,573.6875 Q79.4225,573.925 79.1038,574.0563 Q78.685,574.2375 78.1725,574.2375 Q77.5725,574.2375 77.0913,574 Q76.7038,573.8125 76.4288,573.4063 Q76.16,573 76.16,572.5188 L76.16,572.0813 Q76.16,571.5813 76.3975,571.1438 Q76.6413,570.7063 77.06,570.475 Q77.485,570.2375 77.96,570.2375 Q78.2475,570.2375 78.4975,570.3375 Q78.7475,570.4375 78.96,570.6375 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="4.8" font-style="italic" lengthAdjust="spacing" textLength="13.6" x="93.84" y="570.9828">«fsm»</text><text fill="#000000" font-family="sans-serif" font-size="4.8" lengthAdjust="spacing" textLength="33.6" x="83.84" y="577.0203">TrafficLightFSM</text><line style="stroke:#A80036;stroke-width:0.6000000000000001;" x1="72.2" x2="118.6" y1="580.075" y2="580.075"/><line style="stroke:#A80036;stroke-width:0.6000000000000001;" x1="72.2" x2="118.6" y1="583.275" y2="583.275"/><text fill="#000000" font-family="sans-serif" font-size="4.4" lengthAdjust="spacing" textLength="42.4" x="74.2" y="589.4426">fun start() «suspend»</text><text fill="#000000" font-family="sans-serif" font-size="4.4" lengthAdjust="spacing" textLength="42" x="74.2" y="594.977">fun stop() «suspend»</text><!--MD5=[24d80c7a7824efcf0b8bd16fe5b50cae]
class TrafficLightService--><rect codeLine="41" fill="#FEFECE" filter="url(#fiai61dau77o4)" height="99.9563" id="TrafficLightService" style="stroke:#A80036;stroke-width:0.6000000000000001;" width="108" x="55" y="347.2"/><ellipse cx="79.5" cy="355.2375" fill="#ADD1B2" rx="4.4" ry="4.4" style="stroke:#A80036;stroke-width:0.4000000000000001;"/><path d="M80.3,353.8375 Q80.3813,353.6375 80.475,353.5375 Q80.5688,353.4375 80.675,353.4375 Q80.8625,353.4375 80.9813,353.55 Q81.1,353.6625 81.1,353.925 L81.1,354.55 Q81.1,354.8125 80.9875,354.925 Q80.875,355.0375 80.7,355.0375 Q80.5438,355.0375 80.4438,354.9688 Q80.3438,354.9 80.3,354.7188 Q80.2813,354.5938 80.2125,354.525 Q80.0875,354.3938 79.8625,354.3188 Q79.6375,354.2375 79.4125,354.2375 Q79.1313,354.2375 78.8938,354.35 Q78.6625,354.4625 78.4813,354.7125 Q78.3,354.9625 78.3,355.3063 L78.3,355.675 Q78.3,356.0875 78.6375,356.3625 Q78.975,356.6375 79.575,356.6375 Q79.9313,356.6375 80.1813,356.5563 Q80.325,356.5125 80.4875,356.3688 Q80.5938,356.2875 80.65,356.2625 Q80.7063,356.2375 80.775,356.2375 Q80.9063,356.2375 81,356.3438 Q81.1,356.4438 81.1,356.5875 Q81.1,356.725 80.9625,356.8875 Q80.7625,357.125 80.4438,357.2563 Q80.025,357.4375 79.5125,357.4375 Q78.9125,357.4375 78.4313,357.2 Q78.0438,357.0125 77.7688,356.6063 Q77.5,356.2 77.5,355.7188 L77.5,355.2813 Q77.5,354.7813 77.7375,354.3438 Q77.9813,353.9063 78.4,353.675 Q78.825,353.4375 79.3,353.4375 Q79.5875,353.4375 79.8375,353.5375 Q80.0875,353.6375 80.3,353.8375 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="4.8" font-style="italic" lengthAdjust="spacing" textLength="57.2" x="86.9" y="354.1828">«context-implementation»</text><text fill="#000000" font-family="sans-serif" font-size="4.8" lengthAdjust="spacing" textLength="40" x="95.5" y="360.2203">TrafficLightService</text><line style="stroke:#A80036;stroke-width:0.6000000000000001;" x1="55.4" x2="162.6" y1="363.275" y2="363.275"/><text fill="#000000" font-family="sans-serif" font-size="4.4" lengthAdjust="spacing" textLength="24" x="57.4" y="369.4426">name: String</text><text fill="#000000" font-family="sans-serif" font-size="4.4" lengthAdjust="spacing" textLength="38.8" x="57.4" y="374.977">amberTimeout: Long</text><text fill="#000000" font-family="sans-serif" font-size="4.4" lengthAdjust="spacing" textLength="54.4" x="57.4" y="380.5113">amber: StateFlow&lt;Boolean&gt;</text><text fill="#000000" font-family="sans-serif" font-size="4.4" lengthAdjust="spacing" textLength="48.8" x="57.4" y="386.0457">red: StateFlow&lt;Boolean&gt;</text><text fill="#000000" font-family="sans-serif" font-size="4.4" lengthAdjust="spacing" textLength="53.6" x="57.4" y="391.5801">green: StateFlow&lt;Boolean&gt;</text><text fill="#000000" font-family="sans-serif" font-size="4.4" lengthAdjust="spacing" textLength="56" x="57.4" y="397.1145">stopped: SharedFlow&lt;Long&gt;</text><text fill="#000000" font-family="sans-serif" font-size="4.4" lengthAdjust="spacing" textLength="70.8" x="57.4" y="402.6488">state: StateFlow&lt;TrafficLightStates&gt;</text><line style="stroke:#A80036;stroke-width:0.6000000000000001;" x1="55.4" x2="162.6" y1="405.2156" y2="405.2156"/><text fill="#000000" font-family="sans-serif" font-size="4.4" lengthAdjust="spacing" textLength="67.6" x="57.4" y="411.3832">changeAmberTimeout(value: Long)</text><text fill="#000000" font-family="sans-serif" font-size="4.4" lengthAdjust="spacing" textLength="0" x="58.6" y="416.9176"/><text fill="#000000" font-family="sans-serif" font-size="4.4" lengthAdjust="spacing" textLength="48" x="57.4" y="422.452">setStopped() «suspend»</text><text fill="#000000" font-family="sans-serif" font-size="4.4" lengthAdjust="spacing" textLength="69.6" x="57.4" y="427.9863">switchRed(on: Boolean) «suspend»</text><text fill="#000000" font-family="sans-serif" font-size="4.4" lengthAdjust="spacing" textLength="74.8" x="57.4" y="433.5207">switchAmber(on: Boolean) «suspend»</text><text fill="#000000" font-family="sans-serif" font-size="4.4" lengthAdjust="spacing" textLength="74" x="57.4" y="439.0551">switchGreen(on: Boolean) «suspend»</text><text fill="#000000" font-family="sans-serif" font-size="4.4" lengthAdjust="spacing" textLength="103.2" x="57.4" y="444.5895">stateChanged(toState: TrafficLightStates) «suspend»</text><!--MD5=[9749051c974da246c300c6b23f53e7a6]
class IntersectionStates--><rect codeLine="62" fill="#FEFECE" filter="url(#fiai61dau77o4)" height="44.6125" id="IntersectionStates" style="stroke:#A80036;stroke-width:0.6000000000000001;" width="52.4" x="354" y="486.6"/><ellipse cx="360" cy="494.6375" fill="#EB937F" rx="4.4" ry="4.4" style="stroke:#A80036;stroke-width:0.4000000000000001;"/><path d="M359.4,495.0375 L359.4,495.8375 L361,495.8375 L361,495.4375 L361,495.2438 L361.25,495.0375 L361.4,495.0375 L361.55,495.0375 L361.8,495.2438 L361.8,495.4375 L361.8,496.6375 L358.6,496.6375 L358.4063,496.6375 L358.2,496.3875 L358.2,496.2375 L358.2,496.0875 L358.4063,495.8375 L358.6,495.8375 L358.6,495.8375 L358.6,493.4375 L358.6,493.4375 L358.4063,493.4375 L358.2,493.1875 L358.2,493.0375 L358.2,492.8875 L358.4063,492.6375 L358.6,492.6375 L361.8,492.6375 L361.8,493.8375 L361.8,494.0313 L361.55,494.2375 L361.4,494.2375 L361.25,494.2375 L361,494.0313 L361,493.8375 L361,493.4375 L359.4,493.4375 L359.4,494.2375 L359.8,494.2375 L359.8,494.0438 L359.8,494.0438 L360.05,493.8375 L360.2,493.8375 L360.35,493.8375 L360.6,494.0438 L360.6,494.2375 L360.6,495.0375 L360.6,495.2313 L360.35,495.4375 L360.35,495.4375 L360.2,495.4375 L360.05,495.4375 L359.8,495.2313 L359.8,495.2313 L359.8,495.0375 L359.4,495.0375 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="4.8" font-style="italic" lengthAdjust="spacing" textLength="25.6" x="372.6" y="493.5828">«fsm-state»</text><text fill="#000000" font-family="sans-serif" font-size="4.8" lengthAdjust="spacing" textLength="39.6" x="365.6" y="499.6203">IntersectionStates</text><line style="stroke:#A80036;stroke-width:0.6000000000000001;" x1="354.4" x2="406" y1="502.675" y2="502.675"/><text fill="#000000" font-family="sans-serif" font-size="4.4" lengthAdjust="spacing" textLength="20" x="356.4" y="508.8426">STOPPING</text><text fill="#000000" font-family="sans-serif" font-size="4.4" lengthAdjust="spacing" textLength="17.2" x="356.4" y="514.377">WAITING</text><text fill="#000000" font-family="sans-serif" font-size="4.4" lengthAdjust="spacing" textLength="13.2" x="356.4" y="519.9113">GOING</text><text fill="#000000" font-family="sans-serif" font-size="4.4" lengthAdjust="spacing" textLength="18.4" x="356.4" y="525.4457">STOPPED</text><line style="stroke:#A80036;stroke-width:0.6000000000000001;" x1="354.4" x2="406" y1="528.0125" y2="528.0125"/><!--MD5=[335fb609bd3f47ab478c9b95fb231727]
class IntersectionEvents--><rect codeLine="69" fill="#FEFECE" filter="url(#fiai61dau77o4)" height="44.6125" id="IntersectionEvents" style="stroke:#A80036;stroke-width:0.6000000000000001;" width="53.2" x="420.4" y="486.6"/><ellipse cx="426.4" cy="494.6375" fill="#EB937F" rx="4.4" ry="4.4" style="stroke:#A80036;stroke-width:0.4000000000000001;"/><path d="M425.8,495.0375 L425.8,495.8375 L427.4,495.8375 L427.4,495.4375 L427.4,495.2438 L427.65,495.0375 L427.8,495.0375 L427.95,495.0375 L428.2,495.2438 L428.2,495.4375 L428.2,496.6375 L425,496.6375 L424.8063,496.6375 L424.6,496.3875 L424.6,496.2375 L424.6,496.0875 L424.8063,495.8375 L425,495.8375 L425,495.8375 L425,493.4375 L425,493.4375 L424.8063,493.4375 L424.6,493.1875 L424.6,493.0375 L424.6,492.8875 L424.8063,492.6375 L425,492.6375 L428.2,492.6375 L428.2,493.8375 L428.2,494.0313 L427.95,494.2375 L427.8,494.2375 L427.65,494.2375 L427.4,494.0313 L427.4,493.8375 L427.4,493.4375 L425.8,493.4375 L425.8,494.2375 L426.2,494.2375 L426.2,494.0438 L426.2,494.0438 L426.45,493.8375 L426.6,493.8375 L426.75,493.8375 L427,494.0438 L427,494.2375 L427,495.0375 L427,495.2313 L426.75,495.4375 L426.75,495.4375 L426.6,495.4375 L426.45,495.4375 L426.2,495.2313 L426.2,495.2313 L426.2,495.0375 L425.8,495.0375 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="4.8" font-style="italic" lengthAdjust="spacing" textLength="27.2" x="438.6" y="493.5828">«fsm-event»</text><text fill="#000000" font-family="sans-serif" font-size="4.8" lengthAdjust="spacing" textLength="40.4" x="432" y="499.6203">IntersectionEvents</text><line style="stroke:#A80036;stroke-width:0.6000000000000001;" x1="420.8" x2="473.2" y1="502.675" y2="502.675"/><text fill="#000000" font-family="sans-serif" font-size="4.4" lengthAdjust="spacing" textLength="16.8" x="422.8" y="508.8426">SWITCH,</text><text fill="#000000" font-family="sans-serif" font-size="4.4" lengthAdjust="spacing" textLength="19.6" x="422.8" y="514.377">STOPPED,</text><text fill="#000000" font-family="sans-serif" font-size="4.4" lengthAdjust="spacing" textLength="12" x="422.8" y="519.9113">STOP,</text><text fill="#000000" font-family="sans-serif" font-size="4.4" lengthAdjust="spacing" textLength="13.6" x="422.8" y="525.4457">START</text><line style="stroke:#A80036;stroke-width:0.6000000000000001;" x1="420.8" x2="473.2" y1="528.0125" y2="528.0125"/><!--MD5=[9868cacd5d1749ce2e997e727c15cdbd]
class TrafficIntersectionContext--><rect codeLine="76" fill="#FEFECE" filter="url(#fiai61dau77o4)" height="61.2156" id="TrafficIntersectionContext" style="stroke:#A80036;stroke-width:0.6000000000000001;" width="111.2" x="228.6" y="478.4"/><ellipse cx="254.7" cy="486.4375" fill="#B4A7E5" rx="4.4" ry="4.4" style="stroke:#A80036;stroke-width:0.4000000000000001;"/><path d="M255.1,485.2375 L255.1,487.6375 L255.9,487.6375 L256.0938,487.6375 L256.3,487.8875 L256.3,488.0375 L256.3,488.1875 L256.0938,488.4375 L255.9,488.4375 L253.5,488.4375 L253.3063,488.4375 L253.1,488.1875 L253.1,488.0375 L253.1,487.8875 L253.3063,487.6375 L253.5,487.6375 L254.3,487.6375 L254.3,485.2375 L253.5,485.2375 L253.3063,485.2375 L253.1,484.9875 L253.1,484.8375 L253.1,484.6875 L253.3063,484.4375 L253.5,484.4375 L255.9,484.4375 L256.0938,484.4375 L256.3,484.6875 L256.3,484.8375 L256.3,484.9875 L256.0938,485.2375 L255.9,485.2375 L255.1,485.2375 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="4.8" font-style="italic" lengthAdjust="spacing" textLength="30.8" x="275.3" y="485.3828">«fsm-context»</text><text fill="#000000" font-family="sans-serif" font-size="4.8" font-style="italic" lengthAdjust="spacing" textLength="55.6" x="262.9" y="491.4203">TrafficIntersectionContext</text><line style="stroke:#A80036;stroke-width:0.6000000000000001;" x1="229" x2="339.4" y1="494.475" y2="494.475"/><text fill="#000000" font-family="sans-serif" font-size="4.4" lengthAdjust="spacing" textLength="38" x="231" y="500.6426">val cycleTime: Long</text><text fill="#000000" font-family="sans-serif" font-size="4.4" lengthAdjust="spacing" textLength="46.4" x="231" y="506.177">val cycleWaitTime: Long</text><line style="stroke:#A80036;stroke-width:0.6000000000000001;" x1="229" x2="339.4" y1="508.7438" y2="508.7438"/><text fill="#000000" font-family="sans-serif" font-size="4.4" lengthAdjust="spacing" textLength="106.4" x="231" y="514.9113">suspend fun stateChanged(toState: IntersectionStates)</text><text fill="#000000" font-family="sans-serif" font-size="4.4" lengthAdjust="spacing" textLength="60.4" x="231" y="520.4457">suspend fun start() «suspend»</text><text fill="#000000" font-family="sans-serif" font-size="4.4" lengthAdjust="spacing" textLength="60" x="231" y="525.9801">suspend fun stop() «suspend»</text><text fill="#000000" font-family="sans-serif" font-size="4.4" lengthAdjust="spacing" textLength="60" x="231" y="531.5145">suspend fun next() «suspend»</text><text fill="#000000" font-family="sans-serif" font-size="4.4" lengthAdjust="spacing" textLength="57.2" x="231" y="537.0488">suspend fun off() «suspend»</text><!--MD5=[c56cb48cb5367e6a067e96aa34014d4b]
class TrafficIntersectionFSM--><rect codeLine="86" fill="#FEFECE" filter="url(#fiai61dau77o4)" height="55.6813" id="TrafficIntersectionFSM" style="stroke:#A80036;stroke-width:0.6000000000000001;" width="85.6" x="333" y="369.4"/><ellipse cx="349.98" cy="377.4375" fill="#ADD1B2" rx="4.4" ry="4.4" style="stroke:#A80036;stroke-width:0.4000000000000001;"/><path d="M350.78,376.0375 Q350.8613,375.8375 350.955,375.7375 Q351.0488,375.6375 351.155,375.6375 Q351.3425,375.6375 351.4613,375.75 Q351.58,375.8625 351.58,376.125 L351.58,376.75 Q351.58,377.0125 351.4675,377.125 Q351.355,377.2375 351.18,377.2375 Q351.0238,377.2375 350.9238,377.1688 Q350.8238,377.1 350.78,376.9188 Q350.7613,376.7938 350.6925,376.725 Q350.5675,376.5938 350.3425,376.5188 Q350.1175,376.4375 349.8925,376.4375 Q349.6113,376.4375 349.3738,376.55 Q349.1425,376.6625 348.9613,376.9125 Q348.78,377.1625 348.78,377.5063 L348.78,377.875 Q348.78,378.2875 349.1175,378.5625 Q349.455,378.8375 350.055,378.8375 Q350.4113,378.8375 350.6613,378.7563 Q350.805,378.7125 350.9675,378.5688 Q351.0738,378.4875 351.13,378.4625 Q351.1863,378.4375 351.255,378.4375 Q351.3863,378.4375 351.48,378.5438 Q351.58,378.6438 351.58,378.7875 Q351.58,378.925 351.4425,379.0875 Q351.2425,379.325 350.9238,379.4563 Q350.505,379.6375 349.9925,379.6375 Q349.3925,379.6375 348.9113,379.4 Q348.5238,379.2125 348.2488,378.8063 Q347.98,378.4 347.98,377.9188 L347.98,377.4813 Q347.98,376.9813 348.2175,376.5438 Q348.4613,376.1063 348.88,375.875 Q349.305,375.6375 349.78,375.6375 Q350.0675,375.6375 350.3175,375.7375 Q350.5675,375.8375 350.78,376.0375 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="4.8" font-style="italic" lengthAdjust="spacing" textLength="13.6" x="375.42" y="376.3828">«fsm»</text><text fill="#000000" font-family="sans-serif" font-size="4.8" lengthAdjust="spacing" textLength="48.4" x="358.02" y="382.4203">TrafficIntersectionFSM</text><line style="stroke:#A80036;stroke-width:0.6000000000000001;" x1="333.4" x2="418.2" y1="385.475" y2="385.475"/><text fill="#000000" font-family="sans-serif" font-size="4.4" lengthAdjust="spacing" textLength="61.2" x="335.4" y="391.6426">currentState: IntersectionStates</text><line style="stroke:#A80036;stroke-width:0.6000000000000001;" x1="333.4" x2="418.2" y1="394.2094" y2="394.2094"/><text fill="#000000" font-family="sans-serif" font-size="4.4" lengthAdjust="spacing" textLength="80.8" x="335.4" y="400.377">allowedEvents(): Set&lt;IntersectionEvents&gt;</text><text fill="#000000" font-family="sans-serif" font-size="4.4" lengthAdjust="spacing" textLength="57.2" x="335.4" y="405.9113">startIntersection() «suspend»</text><text fill="#000000" font-family="sans-serif" font-size="4.4" lengthAdjust="spacing" textLength="56.8" x="335.4" y="411.4457">stopIntersection() «suspend»</text><text fill="#000000" font-family="sans-serif" font-size="4.4" lengthAdjust="spacing" textLength="61.6" x="335.4" y="416.9801">switchIntersection() «suspend»</text><text fill="#000000" font-family="sans-serif" font-size="4.4" lengthAdjust="spacing" textLength="41.6" x="335.4" y="422.5145">stopped() «suspend»</text><!--MD5=[67a963a920e61d5a3e163bee231ae3ae]
class TrafficIntersectionController--><rect codeLine="99" fill="#FEFECE" filter="url(#fiai61dau77o4)" height="118.8188" id="TrafficIntersectionController" style="stroke:#A80036;stroke-width:0.6000000000000001;" width="127.2" x="130.2" y="197.2"/><ellipse cx="161.9" cy="203.6" fill="#B4A7E5" rx="4.4" ry="4.4" style="stroke:#A80036;stroke-width:0.4000000000000001;"/><path d="M162.3,202.4 L162.3,204.8 L163.1,204.8 L163.2938,204.8 L163.5,205.05 L163.5,205.2 L163.5,205.35 L163.2938,205.6 L163.1,205.6 L160.7,205.6 L160.5063,205.6 L160.3,205.35 L160.3,205.2 L160.3,205.05 L160.5063,204.8 L160.7,204.8 L161.5,204.8 L161.5,202.4 L160.7,202.4 L160.5063,202.4 L160.3,202.15 L160.3,202 L160.3,201.85 L160.5063,201.6 L160.7,201.6 L163.1,201.6 L163.2938,201.6 L163.5,201.85 L163.5,202 L163.5,202.15 L163.2938,202.4 L163.1,202.4 L162.3,202.4 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="4.8" font-style="italic" lengthAdjust="spacing" textLength="60.4" x="170.1" y="205.5641">TrafficIntersectionController</text><line style="stroke:#A80036;stroke-width:0.6000000000000001;" x1="130.6" x2="257" y1="210" y2="210"/><text fill="#000000" font-family="sans-serif" font-size="4.4" lengthAdjust="spacing" textLength="38.8" x="132.6" y="216.1676">amberTimeout: Long</text><text fill="#000000" font-family="sans-serif" font-size="4.4" lengthAdjust="spacing" textLength="71.2" x="132.6" y="221.702">state: StateFlow&lt;IntersectionStates&gt;</text><text fill="#000000" font-family="sans-serif" font-size="4.4" lengthAdjust="spacing" textLength="56" x="132.6" y="227.2363">stopped: SharedFlow&lt;Long&gt;</text><text fill="#000000" font-family="sans-serif" font-size="4.4" lengthAdjust="spacing" textLength="38.4" x="132.6" y="232.7707">currentName: String</text><text fill="#000000" font-family="sans-serif" font-size="4.4" lengthAdjust="spacing" textLength="53.2" x="132.6" y="238.3051">current: TrafficLightContext</text><text fill="#000000" font-family="sans-serif" font-size="4.4" lengthAdjust="spacing" textLength="41.6" x="132.6" y="243.8395">listOrder: List&lt;String&gt;</text><line style="stroke:#A80036;stroke-width:0.6000000000000001;" x1="130.6" x2="257" y1="246.4063" y2="246.4063"/><text fill="#000000" font-family="sans-serif" font-size="4.4" lengthAdjust="spacing" textLength="76" x="132.6" y="252.5738">get(name: String): TrafficLightController</text><text fill="#000000" font-family="sans-serif" font-size="4.4" lengthAdjust="spacing" textLength="59.6" x="132.6" y="258.1082">changeCycleTime(value: Long)</text><text fill="#000000" font-family="sans-serif" font-size="4.4" lengthAdjust="spacing" textLength="68" x="132.6" y="263.6426">changeCycleWaitTime(value: Long)</text><text fill="#000000" font-family="sans-serif" font-size="4.4" lengthAdjust="spacing" textLength="67.6" x="132.6" y="269.177">changeAmberTimeout(value: Long)</text><text fill="#000000" font-family="sans-serif" font-size="4.4" lengthAdjust="spacing" textLength="122.4" x="132.6" y="274.7113">addTrafficLight(name: String, trafficLight: TrafficLightController)</text><text fill="#000000" font-family="sans-serif" font-size="4.4" lengthAdjust="spacing" textLength="80.8" x="132.6" y="280.2457">allowedEvents(): Set&lt;IntersectionEvents&gt;</text><text fill="#000000" font-family="sans-serif" font-size="4.4" lengthAdjust="spacing" textLength="36.4" x="132.6" y="285.7801">setupIntersection()</text><text fill="#000000" font-family="sans-serif" font-size="4.4" lengthAdjust="spacing" textLength="18.8" x="132.6" y="291.3145">stopped()</text><text fill="#000000" font-family="sans-serif" font-size="4.4" lengthAdjust="spacing" textLength="58" x="132.6" y="296.8488">startTrafficLight(name: String)</text><text fill="#000000" font-family="sans-serif" font-size="4.4" lengthAdjust="spacing" textLength="26.4" x="132.6" y="302.3832">startSystem()</text><text fill="#000000" font-family="sans-serif" font-size="4.4" lengthAdjust="spacing" textLength="26" x="132.6" y="307.9176">stopSystem()</text><text fill="#000000" font-family="sans-serif" font-size="4.4" lengthAdjust="spacing" textLength="16.4" x="132.6" y="313.452">switch()</text><!--MD5=[09381f51bdf889138526ece6de7cd791]
class TrafficIntersectionService--><rect codeLine="123" fill="#FEFECE" filter="url(#fiai61dau77o4)" height="163.0938" id="TrafficIntersectionService" style="stroke:#A80036;stroke-width:0.6000000000000001;" width="127.2" x="172.6" y="2.8"/><ellipse cx="207.1" cy="9.2" fill="#ADD1B2" rx="4.4" ry="4.4" style="stroke:#A80036;stroke-width:0.4000000000000001;"/><path d="M207.9,7.8 Q207.9813,7.6 208.075,7.5 Q208.1688,7.4 208.275,7.4 Q208.4625,7.4 208.5813,7.5125 Q208.7,7.625 208.7,7.8875 L208.7,8.5125 Q208.7,8.775 208.5875,8.8875 Q208.475,9 208.3,9 Q208.1438,9 208.0438,8.9313 Q207.9438,8.8625 207.9,8.6813 Q207.8813,8.5563 207.8125,8.4875 Q207.6875,8.3563 207.4625,8.2813 Q207.2375,8.2 207.0125,8.2 Q206.7313,8.2 206.4938,8.3125 Q206.2625,8.425 206.0813,8.675 Q205.9,8.925 205.9,9.2688 L205.9,9.6375 Q205.9,10.05 206.2375,10.325 Q206.575,10.6 207.175,10.6 Q207.5313,10.6 207.7813,10.5188 Q207.925,10.475 208.0875,10.3313 Q208.1938,10.25 208.25,10.225 Q208.3063,10.2 208.375,10.2 Q208.5063,10.2 208.6,10.3063 Q208.7,10.4063 208.7,10.55 Q208.7,10.6875 208.5625,10.85 Q208.3625,11.0875 208.0438,11.2188 Q207.625,11.4 207.1125,11.4 Q206.5125,11.4 206.0313,11.1625 Q205.6438,10.975 205.3688,10.5688 Q205.1,10.1625 205.1,9.6813 L205.1,9.2438 Q205.1,8.7438 205.3375,8.3063 Q205.5813,7.8688 206,7.6375 Q206.425,7.4 206.9,7.4 Q207.1875,7.4 207.4375,7.5 Q207.6875,7.6 207.9,7.8 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="4.8" lengthAdjust="spacing" textLength="54.8" x="215.3" y="11.1641">TrafficIntersectionService</text><line style="stroke:#A80036;stroke-width:0.6000000000000001;" x1="173" x2="299.4" y1="15.6" y2="15.6"/><text fill="#000000" font-family="sans-serif" font-size="4.4" lengthAdjust="spacing" textLength="71.2" x="175" y="21.7676">state: StateFlow&lt;IntersectionStates&gt;</text><text fill="#000000" font-family="sans-serif" font-size="4.4" lengthAdjust="spacing" textLength="56" x="175" y="27.302">stopped: SharedFlow&lt;Long&gt;</text><text fill="#000000" font-family="sans-serif" font-size="4.4" lengthAdjust="spacing" textLength="38.8" x="175" y="32.8363">amberTimeout: Long</text><text fill="#000000" font-family="sans-serif" font-size="4.4" lengthAdjust="spacing" textLength="41.6" x="175" y="38.3707">listOrder: List&lt;String&gt;</text><text fill="#000000" font-family="sans-serif" font-size="4.4" lengthAdjust="spacing" textLength="31.2" x="175" y="43.9051">cycleTime: Long</text><text fill="#000000" font-family="sans-serif" font-size="4.4" lengthAdjust="spacing" textLength="38.4" x="175" y="49.4395">currentName: String</text><text fill="#000000" font-family="sans-serif" font-size="4.4" lengthAdjust="spacing" textLength="53.2" x="175" y="54.9738">current: TrafficLightContext</text><text fill="#000000" font-family="sans-serif" font-size="4.4" lengthAdjust="spacing" textLength="39.6" x="175" y="60.5082">cycleWaitTime: Long</text><text fill="#000000" font-family="sans-serif" font-size="4.4" lengthAdjust="spacing" textLength="61.2" x="175" y="66.0426">currentState: IntersectionStates</text><line style="stroke:#A80036;stroke-width:0.6000000000000001;" x1="173" x2="299.4" y1="68.6094" y2="68.6094"/><text fill="#000000" font-family="sans-serif" font-size="4.4" lengthAdjust="spacing" textLength="67.6" x="175" y="74.777">changeAmberTimeout(value: Long)</text><text fill="#000000" font-family="sans-serif" font-size="4.4" lengthAdjust="spacing" textLength="36.4" x="175" y="80.3113">setupIntersection()</text><text fill="#000000" font-family="sans-serif" font-size="4.4" lengthAdjust="spacing" textLength="76" x="175" y="85.8457">get(name: String): TrafficLightController</text><text fill="#000000" font-family="sans-serif" font-size="4.4" lengthAdjust="spacing" textLength="122.4" x="175" y="91.3801">addTrafficLight(name: String, trafficLight: TrafficLightController)</text><text fill="#000000" font-family="sans-serif" font-size="4.4" lengthAdjust="spacing" textLength="58" x="175" y="96.9145">startTrafficLight(name: String)</text><text fill="#000000" font-family="sans-serif" font-size="4.4" lengthAdjust="spacing" textLength="80.8" x="175" y="102.4488">stateChanged(toState: IntersectionStates)</text><text fill="#000000" font-family="sans-serif" font-size="4.4" lengthAdjust="spacing" textLength="59.6" x="175" y="107.9832">changeCycleTime(value: Long)</text><text fill="#000000" font-family="sans-serif" font-size="4.4" lengthAdjust="spacing" textLength="68" x="175" y="113.5176">changeCycleWaitTime(value: Long)</text><text fill="#000000" font-family="sans-serif" font-size="4.4" lengthAdjust="spacing" textLength="12" x="175" y="119.052">start()</text><text fill="#000000" font-family="sans-serif" font-size="4.4" lengthAdjust="spacing" textLength="11.6" x="175" y="124.5863">stop()</text><text fill="#000000" font-family="sans-serif" font-size="4.4" lengthAdjust="spacing" textLength="8.8" x="175" y="130.1207">off()</text><text fill="#000000" font-family="sans-serif" font-size="4.4" lengthAdjust="spacing" textLength="11.6" x="175" y="135.6551">next()</text><text fill="#000000" font-family="sans-serif" font-size="4.4" lengthAdjust="spacing" textLength="26.4" x="175" y="141.1895">startSystem()</text><text fill="#000000" font-family="sans-serif" font-size="4.4" lengthAdjust="spacing" textLength="26" x="175" y="146.7238">stopSystem()</text><text fill="#000000" font-family="sans-serif" font-size="4.4" lengthAdjust="spacing" textLength="16.4" x="175" y="152.2582">switch()</text><text fill="#000000" font-family="sans-serif" font-size="4.4" lengthAdjust="spacing" textLength="18.8" x="175" y="157.7926">stopped()</text><text fill="#000000" font-family="sans-serif" font-size="4.4" lengthAdjust="spacing" textLength="80.8" x="175" y="163.327">allowedEvents(): Set&lt;IntersectionEvents&gt;</text><!--MD5=[ce902affe73128e0a9c1460ddb6351ac]
class TrafficIntersectionViewModel--><rect codeLine="157" fill="#90EE90" filter="url(#fiai61dau77o4)" height="99.9563" id="TrafficIntersectionViewModel" style="stroke:#A80036;stroke-width:0.6000000000000001;" width="105.6" x="7" y="34.4"/><ellipse cx="26.9" cy="42.4375" fill="#ADD1B2" rx="4.4" ry="4.4" style="stroke:#A80036;stroke-width:0.4000000000000001;"/><path d="M27.7,41.0375 Q27.7813,40.8375 27.875,40.7375 Q27.9688,40.6375 28.075,40.6375 Q28.2625,40.6375 28.3813,40.75 Q28.5,40.8625 28.5,41.125 L28.5,41.75 Q28.5,42.0125 28.3875,42.125 Q28.275,42.2375 28.1,42.2375 Q27.9438,42.2375 27.8438,42.1688 Q27.7438,42.1 27.7,41.9188 Q27.6813,41.7938 27.6125,41.725 Q27.4875,41.5938 27.2625,41.5188 Q27.0375,41.4375 26.8125,41.4375 Q26.5313,41.4375 26.2938,41.55 Q26.0625,41.6625 25.8813,41.9125 Q25.7,42.1625 25.7,42.5063 L25.7,42.875 Q25.7,43.2875 26.0375,43.5625 Q26.375,43.8375 26.975,43.8375 Q27.3313,43.8375 27.5813,43.7563 Q27.725,43.7125 27.8875,43.5688 Q27.9938,43.4875 28.05,43.4625 Q28.1063,43.4375 28.175,43.4375 Q28.3063,43.4375 28.4,43.5438 Q28.5,43.6438 28.5,43.7875 Q28.5,43.925 28.3625,44.0875 Q28.1625,44.325 27.8438,44.4563 Q27.425,44.6375 26.9125,44.6375 Q26.3125,44.6375 25.8313,44.4 Q25.4438,44.2125 25.1688,43.8063 Q24.9,43.4 24.9,42.9188 L24.9,42.4813 Q24.9,41.9813 25.1375,41.5438 Q25.3813,41.1063 25.8,40.875 Q26.225,40.6375 26.7,40.6375 Q26.9875,40.6375 27.2375,40.7375 Q27.4875,40.8375 27.7,41.0375 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="4.8" font-style="italic" lengthAdjust="spacing" textLength="29.2" x="51.7" y="41.3828">«viewmodel»</text><text fill="#000000" font-family="sans-serif" font-size="4.8" lengthAdjust="spacing" textLength="62.4" x="35.1" y="47.4203">TrafficIntersectionViewModel</text><line style="stroke:#A80036;stroke-width:0.6000000000000001;" x1="7.4" x2="112.2" y1="50.475" y2="50.475"/><text fill="#000000" font-family="sans-serif" font-size="4.4" lengthAdjust="spacing" textLength="45.6" x="9.4" y="56.6426">val amberTimeout: Long</text><text fill="#000000" font-family="sans-serif" font-size="4.4" lengthAdjust="spacing" textLength="46.4" x="9.4" y="62.177">val cycleWaitTime: Long</text><text fill="#000000" font-family="sans-serif" font-size="4.4" lengthAdjust="spacing" textLength="38" x="9.4" y="67.7113">val cycleTime: Long</text><text fill="#000000" font-family="sans-serif" font-size="4.4" lengthAdjust="spacing" textLength="45.2" x="9.4" y="73.2457">val currentName: String</text><text fill="#000000" font-family="sans-serif" font-size="4.4" lengthAdjust="spacing" textLength="84.4" x="9.4" y="78.7801">val trafficLights: List&lt;TrafficLightController&gt;</text><text fill="#000000" font-family="sans-serif" font-size="4.4" lengthAdjust="spacing" textLength="0" x="10.6" y="84.3145"/><text fill="#000000" font-family="sans-serif" font-size="4.4" lengthAdjust="spacing" textLength="100.8" x="9.4" y="89.8488">val intersectionState: StateFlow&lt;IntersectionStates&gt;</text><text fill="#000000" font-family="sans-serif" font-size="4.4" lengthAdjust="spacing" textLength="68.8" x="9.4" y="95.3832">val allowStart: StateFlow&lt;Boolean&gt;</text><text fill="#000000" font-family="sans-serif" font-size="4.4" lengthAdjust="spacing" textLength="73.2" x="9.4" y="100.9176">val allowSwitch: StateFlow&lt;Boolean&gt;</text><text fill="#000000" font-family="sans-serif" font-size="4.4" lengthAdjust="spacing" textLength="68.4" x="9.4" y="106.452">val allowStop: StateFlow&lt;Boolean&gt;</text><text fill="#000000" font-family="sans-serif" font-size="4.4" lengthAdjust="spacing" textLength="84.4" x="9.4" y="111.9863">val trafficLights: List&lt;TrafficLightController&gt;</text><line style="stroke:#A80036;stroke-width:0.6000000000000001;" x1="7.4" x2="112.2" y1="114.5531" y2="114.5531"/><text fill="#000000" font-family="sans-serif" font-size="4.4" lengthAdjust="spacing" textLength="49.2" x="9.4" y="120.7207">startSystem() «suspend»</text><text fill="#000000" font-family="sans-serif" font-size="4.4" lengthAdjust="spacing" textLength="48.8" x="9.4" y="126.2551">stopSystem() «suspend»</text><text fill="#000000" font-family="sans-serif" font-size="4.4" lengthAdjust="spacing" textLength="39.2" x="9.4" y="131.7895">switch() «suspend»</text><!--MD5=[e90295f2306cf9f2d48d2dd155fc66d8]
link TrafficLightController to TrafficLightContext--><path codeLine="30" d="M178.4688,535.2876 C180.1704,558.8576 182.7052,593.966 184.64,620.7672 " fill="none" id="TrafficLightController-to-TrafficLightContext" style="stroke:#A80036;stroke-width:0.4000000000000001;"/><polygon fill="none" points="187.436,620.6152,185.2196,628.796,181.8508,621.0184,187.436,620.6152" style="stroke:#A80036;stroke-width:0.4000000000000001;"/><!--MD5=[f5a4d25a21e2db1a9bef5b5bdfa80daf]
link TrafficLightFSM to TrafficLightStates--><path codeLine="37" d="M81.1488,597.6992 C70.9304,609.5292 57.0908,625.552 46.1232,638.2496 " fill="none" id="TrafficLightFSM-to-TrafficLightStates" style="stroke:#A80036;stroke-width:0.4000000000000001;stroke-dasharray:7.0,7.0;"/><polygon fill="#A80036" points="44.8004,639.7812,48.3644,638.1026,46.1077,638.2676,45.9427,636.0109,44.8004,639.7812" style="stroke:#A80036;stroke-width:0.4000000000000001;"/><text fill="#000000" font-family="sans-serif" font-size="5.2" lengthAdjust="spacing" textLength="16.8" x="70.2" y="615.398">«uses»</text><!--MD5=[ef55fa34c35daebc710b7e66915eb99f]
link TrafficLightFSM to TrafficLightEvents--><path codeLine="38" d="M94.976,597.6992 C94.6536,610.232 94.2104,627.47 93.8764,640.4748 " fill="none" id="TrafficLightFSM-to-TrafficLightEvents" style="stroke:#A80036;stroke-width:0.4000000000000001;stroke-dasharray:7.0,7.0;"/><polygon fill="#A80036" points="93.8236,642.5244,95.5156,638.9667,93.875,640.5251,92.3167,638.8844,93.8236,642.5244" style="stroke:#A80036;stroke-width:0.4000000000000001;"/><text fill="#000000" font-family="sans-serif" font-size="5.2" lengthAdjust="spacing" textLength="16.8" x="95.4" y="615.398">«uses»</text><!--MD5=[7d975c74983153482517d07fdba291a6]
link TrafficLightFSM to TrafficLightContext--><path codeLine="39" d="M114.7984,597.6044 C125.0404,606.2656 137.9628,617.1936 150.0572,627.4212 " fill="none" id="TrafficLightFSM-to-TrafficLightContext" style="stroke:#A80036;stroke-width:0.4000000000000001;"/><polygon fill="#A80036" points="151.6808,628.794,149.9647,625.2479,150.1535,627.5027,147.8987,627.6915,151.6808,628.794" style="stroke:#A80036;stroke-width:0.4000000000000001;"/><text fill="#000000" font-family="sans-serif" font-size="5.2" lengthAdjust="spacing" textLength="17.2" x="136.6" y="615.398">context</text><!--MD5=[a14a1606ab3e0ad97f005eafd1d1dbee]
link TrafficLightService to TrafficLightController--><path codeLine="58" d="M139.2412,447.256 C145.1216,456.912 151.1476,466.8068 156.596,475.7532 " fill="none" id="TrafficLightService-to-TrafficLightController" style="stroke:#A80036;stroke-width:0.4000000000000001;"/><polygon fill="none" points="159.0584,474.4132,160.828,482.7024,154.2756,477.326,159.0584,474.4132" style="stroke:#A80036;stroke-width:0.4000000000000001;"/><!--MD5=[b02eea57f08a8734f953d301797f548e]
link TrafficLightService to TrafficLightFSM--><path codeLine="59" d="M104.9456,452.0964 C104.9456,452.0964 98.948,532.712 97.0132,558.714 " fill="none" id="TrafficLightService-TrafficLightFSM" style="stroke:#A80036;stroke-width:0.4000000000000001;"/><polygon fill="#A80036" points="96.6224,563.9716,98.485,560.5002,96.7708,561.9771,95.2938,560.2628,96.6224,563.9716" style="stroke:#A80036;stroke-width:0.4000000000000001;"/><line style="stroke:#A80036;stroke-width:0.4000000000000001;" x1="96.7708" x2="97.0082" y1="561.9771" y2="558.7858"/><polygon fill="#A80036" points="105.3016,447.3096,103.528,449.5843,104.9456,452.0964,106.7192,449.8217,105.3016,447.3096" style="stroke:#A80036;stroke-width:0.4000000000000001;"/><text fill="#000000" font-family="sans-serif" font-size="5.2" lengthAdjust="spacing" textLength="8.4" x="103.4" y="511.198">fsm</text><!--MD5=[02c58767cbaebf5fe961d047052ec028]
link TrafficIntersectionFSM to TrafficIntersectionContext--><path codeLine="95" d="M353.1572,425.0384 C340.2236,440.7108 323.9468,460.4352 310.4548,476.7844 " fill="none" id="TrafficIntersectionFSM-to-TrafficIntersectionContext" style="stroke:#A80036;stroke-width:0.4000000000000001;"/><polygon fill="#A80036" points="309.1584,478.356,312.6838,476.5977,310.4313,476.8134,310.2156,474.561,309.1584,478.356" style="stroke:#A80036;stroke-width:0.4000000000000001;"/><text fill="#000000" font-family="sans-serif" font-size="5.2" lengthAdjust="spacing" textLength="17.2" x="324.6" y="464.998">context</text><!--MD5=[9468340d7453291c53dc9c139c20e995]
link TrafficIntersectionFSM to IntersectionEvents--><path codeLine="96" d="M393.4,425.0384 C405.144,443.3484 420.436,467.1884 431.68,484.7156 " fill="none" id="TrafficIntersectionFSM-to-IntersectionEvents" style="stroke:#A80036;stroke-width:0.4000000000000001;stroke-dasharray:7.0,7.0;"/><polygon fill="#A80036" points="432.824,486.4988,432.2241,482.6052,431.7429,484.8162,429.5319,484.335,432.824,486.4988" style="stroke:#A80036;stroke-width:0.4000000000000001;"/><text fill="#000000" font-family="sans-serif" font-size="5.2" lengthAdjust="spacing" textLength="33.2" x="420.2" y="464.998">events «uses»</text><!--MD5=[fe4ec4b482b722450bc85149b58e4a7c]
link TrafficIntersectionFSM to IntersectionStates--><path codeLine="97" d="M376.8876,425.0384 C377.6092,443.2372 378.5472,466.8996 379.2404,484.3964 " fill="none" id="TrafficIntersectionFSM-to-IntersectionStates" style="stroke:#A80036;stroke-width:0.4000000000000001;stroke-dasharray:7.0,7.0;"/><polygon fill="#A80036" points="379.324,486.4988,380.7808,482.8385,379.2451,484.5004,377.5833,482.9647,379.324,486.4988" style="stroke:#A80036;stroke-width:0.4000000000000001;"/><text fill="#000000" font-family="sans-serif" font-size="5.2" lengthAdjust="spacing" textLength="32.8" x="378.6" y="464.998">states «uses»</text><!--MD5=[f99ab679abda8f782610770a06d7759b]
link TrafficIntersectionController to TrafficIntersectionContext--><path codeLine="120" d="M215.052,316.148 C232.2136,363.912 255.8512,429.6996 270.5688,470.6624 " fill="none" id="TrafficIntersectionController-to-TrafficIntersectionContext" style="stroke:#A80036;stroke-width:0.4000000000000001;"/><polygon fill="none" points="273.2292,469.786,273.2992,478.2616,267.9592,471.6796,273.2292,469.786" style="stroke:#A80036;stroke-width:0.4000000000000001;"/><!--MD5=[623b43cb3e72afdaaab4b9f9f3b9f428]
link TrafficIntersectionController to TrafficLightController--><path codeLine="121" d="M189.4288,320.9368 C189.4288,320.9368 181.3772,438.7176 178.728,477.4732 " fill="none" id="TrafficIntersectionController-TrafficLightController" style="stroke:#A80036;stroke-width:0.4000000000000001;"/><polygon fill="#A80036" points="178.3672,482.7484,180.2088,479.2658,178.5035,480.753,177.0162,479.0477,178.3672,482.7484" style="stroke:#A80036;stroke-width:0.4000000000000001;"/><line style="stroke:#A80036;stroke-width:0.4000000000000001;" x1="178.5035" x2="178.722" y1="480.753" y2="477.5604"/><polygon fill="#A80036" points="189.7564,316.148,187.9964,318.4332,189.4288,320.9368,191.1889,318.6516,189.7564,316.148" style="stroke:#A80036;stroke-width:0.4000000000000001;"/><text fill="#000000" font-family="sans-serif" font-size="5.2" lengthAdjust="spacing" textLength="26.4" x="188.2" y="399.398">trafficLights</text><!--MD5=[213e98c6e1b68eaf0278262acaf92988]
link TrafficIntersectionService to TrafficIntersectionController--><path codeLine="152" d="M216.0864,166.108 C214.166,173.872 212.2336,181.684 210.3524,189.288 " fill="none" id="TrafficIntersectionService-to-TrafficIntersectionController" style="stroke:#A80036;stroke-width:0.4000000000000001;"/><polygon fill="none" points="213.0524,190.032,208.4132,197.128,207.6164,188.688,213.0524,190.032" style="stroke:#A80036;stroke-width:0.4000000000000001;"/><!--MD5=[a0c4c6e1b7e6bd88c7aa08379bf65076]
link TrafficIntersectionService to TrafficIntersectionFSM--><path codeLine="153" d="M285.2392,170.3213 C285.2392,170.3213 287.85,175.6 289,178 C319.8968,242.528 349.1288,321.1248 364.5236,364.3708 " fill="none" id="TrafficIntersectionService-TrafficIntersectionFSM" style="stroke:#A80036;stroke-width:0.4000000000000001;"/><polygon fill="#A80036" points="366.2864,369.3384,366.5904,365.4106,365.6176,367.4535,363.5747,366.4807,366.2864,369.3384" style="stroke:#A80036;stroke-width:0.4000000000000001;"/><line style="stroke:#A80036;stroke-width:0.4000000000000001;" x1="365.6176" x2="364.5472" y1="367.4535" y2="364.4378"/><polygon fill="#A80036" points="283.0768,166.036,282.7296,168.8995,285.2392,170.3213,285.5865,167.4578,283.0768,166.036" style="stroke:#A80036;stroke-width:0.4000000000000001;"/><text fill="#000000" font-family="sans-serif" font-size="5.2" lengthAdjust="spacing" textLength="60" x="346.2" y="258.798">intersectionFSM «private»</text><!--MD5=[5a10fe9a7b46e29ac4c7cf70982de1b2]
link TrafficIntersectionService to TrafficLightController--><path codeLine="154" d="M259.8612,170.7161 C259.8612,170.7161 263.156,188.692 264.2,197.2 C270.6292,249.608 273.0604,263.948 264.2,316 C253.8308,376.9152 245.9832,392.0072 218.2,447.2 C212.8532,457.822 205.95,468.7708 199.3092,478.4288 " fill="none" id="TrafficIntersectionService-TrafficLightController" style="stroke:#A80036;stroke-width:0.4000000000000001;"/><polygon fill="#A80036" points="196.2832,482.7696,199.6545,480.7314,197.427,481.1289,197.0294,478.9014,196.2832,482.7696" style="stroke:#A80036;stroke-width:0.4000000000000001;"/><line style="stroke:#A80036;stroke-width:0.4000000000000001;" x1="197.427" x2="199.257" y1="481.1289" y2="478.5036"/><polygon fill="#A80036" points="258.9064,166.012,257.8158,168.6823,259.8612,170.7161,260.9518,168.0458,258.9064,166.012" style="stroke:#A80036;stroke-width:0.4000000000000001;"/><text fill="#000000" font-family="sans-serif" font-size="5.2" lengthAdjust="spacing" textLength="48.4" x="262.6" y="333.798">trafficLights «private»</text><text fill="#000000" font-family="sans-serif" font-size="5.2" lengthAdjust="spacing" textLength="8.8" x="189.2503" y="478.3725">1..n</text><!--MD5=[0de80cd36f9e186dba893d17ca342858]
link TrafficIntersectionService to TrafficLightService--><path codeLine="155" d="M172.5348,132.612 C153.2456,150.608 134.2152,172.712 123,197.2 C101.6096,243.904 100.26,303.254 102.9356,345.0548 " fill="none" id="TrafficIntersectionService-to-TrafficLightService" style="stroke:#A80036;stroke-width:0.4000000000000001;stroke-dasharray:7.0,7.0;"/><polygon fill="#A80036" points="103.0744,347.1568,104.4344,343.4595,102.943,345.1611,101.2413,343.6697,103.0744,347.1568" style="stroke:#A80036;stroke-width:0.4000000000000001;"/><!--MD5=[a0825e187c969bcbe7623a28eff8e879]
link TrafficIntersectionViewModel to TrafficIntersectionController--><path codeLine="175" d="M98.6484,134.492 C113.5324,153.528 130.6816,175.464 146.2864,195.424 " fill="none" id="TrafficIntersectionViewModel-to-TrafficIntersectionController" style="stroke:#A80036;stroke-width:0.4000000000000001;"/><polygon fill="#A80036" points="147.5988,197.104,146.6388,193.2832,146.3656,195.5294,144.1194,195.2563,147.5988,197.104" style="stroke:#A80036;stroke-width:0.4000000000000001;"/><text fill="#000000" font-family="sans-serif" font-size="5.2" lengthAdjust="spacing" textLength="39.2" x="135.4" y="183.798">trafficIntersection</text><!--MD5=[054b45ed3e0c0b779b9d26c5379aa461]
@startuml

enum TrafficLightStates <<fsm-state>> {
    RED
    AMBER
    GREEN
}

enum TrafficLightEvents <<fsm-event>> {
    STOP
    GO
}
interface TrafficLightContext <<fsm-context>> {
    name: String
    amberTimeout: Long
    setStopped() <<suspend>>
    switchRed(on: Boolean) <<suspend>>
    switchAmber(on: Boolean) <<suspend>>
    switchGreen(on: Boolean) <<suspend>>
    stateChanged(toState: TrafficLightStates) <<suspend>>
}

interface TrafficLightController {
    amber: StateFlow<Boolean>
    red: StateFlow<Boolean>
    green: StateFlow<Boolean>
    stopped: SharedFlow<Long>
    state: StateFlow<TrafficLightStates>
    changeAmberTimeout(value: Long)
}
TrafficLightController -|> TrafficLightContext

class TrafficLightFSM <<fsm>> {
    fun start() <<suspend>>
    fun stop() <<suspend>>
}

TrafficLightFSM ..> TrafficLightStates: <<uses>>
TrafficLightFSM ..> TrafficLightEvents: <<uses>>
TrafficLightFSM - -> TrafficLightContext: context

class TrafficLightService <<context-implementation>> {
    name: String
    amberTimeout: Long
    amber: StateFlow<Boolean>
    red: StateFlow<Boolean>
    green: StateFlow<Boolean>
    stopped: SharedFlow<Long>
    state: StateFlow<TrafficLightStates>
    changeAmberTimeout(value: Long)

    setStopped() <<suspend>>
    switchRed(on: Boolean) <<suspend>>
    switchAmber(on: Boolean) <<suspend>>
    switchGreen(on: Boolean) <<suspend>>
    stateChanged(toState: TrafficLightStates) <<suspend>>
}

TrafficLightService - -|> TrafficLightController
TrafficLightService *- - -> TrafficLightFSM: fsm


enum IntersectionStates <<fsm-state>> {
    STOPPING
    WAITING
    GOING
    STOPPED
}

enum IntersectionEvents <<fsm-event>> {
    SWITCH,
    STOPPED,
    STOP,
    START
}

interface TrafficIntersectionContext <<fsm-context>> {
    val cycleTime: Long
    val cycleWaitTime: Long
    suspend fun stateChanged(toState: IntersectionStates)
    suspend fun start() <<suspend>>
    suspend fun stop() <<suspend>>
    suspend fun next() <<suspend>>
    suspend fun off() <<suspend>>
}

class TrafficIntersectionFSM <<fsm>> {
    currentState: IntersectionStates
    allowedEvents(): Set<IntersectionEvents>
    startIntersection() <<suspend>>
    stopIntersection() <<suspend>>
    switchIntersection() <<suspend>>
    stopped() <<suspend>>
}

TrafficIntersectionFSM - -> TrafficIntersectionContext: context
TrafficIntersectionFSM ..> IntersectionEvents: events <<uses>>
TrafficIntersectionFSM ..> IntersectionStates: states <<uses>>

interface TrafficIntersectionController {
    amberTimeout: Long
    state: StateFlow<IntersectionStates>
    stopped: SharedFlow<Long>
    currentName: String
    current: TrafficLightContext
    listOrder: List<String>
    get(name: String): TrafficLightController
    changeCycleTime(value: Long)
    changeCycleWaitTime(value: Long)
    changeAmberTimeout(value: Long)
    addTrafficLight(name: String, trafficLight: TrafficLightController)
    allowedEvents(): Set<IntersectionEvents>
    setupIntersection()
    stopped()
    startTrafficLight(name: String)
    startSystem()
    stopSystem()
    switch()
}

TrafficIntersectionController - -|> TrafficIntersectionContext
TrafficIntersectionController *- - -> TrafficLightController: trafficLights

class TrafficIntersectionService {
    state: StateFlow<IntersectionStates>
    stopped: SharedFlow<Long>
    amberTimeout: Long
    changeAmberTimeout(value: Long)
    setupIntersection()
    listOrder: List<String>
    cycleTime: Long
        currentName: String
        current: TrafficLightContext
        cycleWaitTime: Long
        currentState: IntersectionStates
    get(name: String): TrafficLightController
    addTrafficLight(name: String, trafficLight: TrafficLightController)
    startTrafficLight(name: String)
    stateChanged(toState: IntersectionStates)
    changeCycleTime(value: Long)
    changeCycleWaitTime(value: Long)
    start()
    stop()
    off()
    next()
    startSystem()
    stopSystem()
    switch()
    stopped()
    allowedEvents(): Set<IntersectionEvents>
}

TrafficIntersectionService - -|> TrafficIntersectionController
TrafficIntersectionService *- - -> TrafficIntersectionFSM: intersectionFSM <<private>>
TrafficIntersectionService *- - -> "1..n" TrafficLightController: trafficLights <<private>>
TrafficIntersectionService ...> TrafficLightService

class TrafficIntersectionViewModel <<viewmodel>> #lightgreen {
    val amberTimeout: Long
    val cycleWaitTime: Long
    val cycleTime: Long
    val currentName: String
    val trafficLights: List<TrafficLightController>

    val intersectionState: StateFlow<IntersectionStates>
    val allowStart: StateFlow<Boolean>
    val allowSwitch: StateFlow<Boolean>
    val allowStop: StateFlow<Boolean>
    val trafficLights: List<TrafficLightController>

    startSystem() <<suspend>>
    stopSystem() <<suspend>>
    switch() <<suspend>>
}

TrafficIntersectionViewModel - -> TrafficIntersectionController: trafficIntersection

@enduml

PlantUML version 1.2021.7(Sun May 23 14:40:07 CAT 2021)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: Cp1252
Language: en
Country: ZA
--></g></svg>