<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="663px" preserveAspectRatio="none" style="width:694px;height:663px;background:#FFFFFF;" version="1.1" viewBox="0 0 694 663" width="694px" zoomAndPan="magnify"><defs><filter height="300%" id="f15hjyl7xojn9a" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><!--MD5=[c317431f81cdf0e8053db5837ef6c822]
class TrafficLightStates--><rect codeLine="2" fill="#FEFECE" filter="url(#f15hjyl7xojn9a)" height="97.6953" id="TrafficLightStates" style="stroke:#A80036;stroke-width:1.5;" width="127" x="553.5" y="362.5"/><ellipse cx="568.5" cy="382.5938" fill="#EB937F" rx="11" ry="11" style="stroke:#A80036;stroke-width:1.0;"/><path d="M567,383.5938 L567,385.5938 L571,385.5938 L571,384.5938 L571,384.1094 L571.625,383.5938 L572,383.5938 L572.375,383.5938 L573,384.1094 L573,384.5938 L573,387.5938 L565,387.5938 L564.5156,387.5938 L564,386.9688 L564,386.5938 L564,386.2188 L564.5156,385.5938 L565,385.5938 L565,385.5938 L565,379.5938 L565,379.5938 L564.5156,379.5938 L564,378.9688 L564,378.5938 L564,378.2188 L564.5156,377.5938 L565,377.5938 L573,377.5938 L573,380.5938 L573,381.0781 L572.375,381.5938 L572,381.5938 L571.625,381.5938 L571,381.0781 L571,380.5938 L571,379.5938 L567,379.5938 L567,381.5938 L568,381.5938 L568,381.1094 L568,381.1094 L568.625,380.5938 L569,380.5938 L569.375,380.5938 L570,381.1094 L570,381.5938 L570,383.5938 L570,384.0781 L569.375,384.5938 L569.375,384.5938 L569,384.5938 L568.625,384.5938 L568,384.0781 L568,384.0781 L568,383.5938 L567,383.5938 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="64" x="598" y="379.957">«fsm-state»</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="95" x="582.5" y="395.0508">TrafficLightStates</text><line style="stroke:#A80036;stroke-width:1.5;" x1="554.5" x2="679.5" y1="402.6875" y2="402.6875"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="20" x="559.5" y="418.1064">RED</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="36" x="559.5" y="431.9424">AMBER</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="34" x="559.5" y="445.7783">GREEN</text><line style="stroke:#A80036;stroke-width:1.5;" x1="554.5" x2="679.5" y1="452.1953" y2="452.1953"/><!--MD5=[082ea4b1b4c949e9e678c41ae71c099b]
class TrafficLightEvents--><rect codeLine="8" fill="#FEFECE" filter="url(#f15hjyl7xojn9a)" height="83.8594" id="TrafficLightEvents" style="stroke:#A80036;stroke-width:1.5;" width="129" x="351.5" y="566"/><ellipse cx="366.5" cy="586.0938" fill="#EB937F" rx="11" ry="11" style="stroke:#A80036;stroke-width:1.0;"/><path d="M365,587.0938 L365,589.0938 L369,589.0938 L369,588.0938 L369,587.6094 L369.625,587.0938 L370,587.0938 L370.375,587.0938 L371,587.6094 L371,588.0938 L371,591.0938 L363,591.0938 L362.5156,591.0938 L362,590.4688 L362,590.0938 L362,589.7188 L362.5156,589.0938 L363,589.0938 L363,589.0938 L363,583.0938 L363,583.0938 L362.5156,583.0938 L362,582.4688 L362,582.0938 L362,581.7188 L362.5156,581.0938 L363,581.0938 L371,581.0938 L371,584.0938 L371,584.5781 L370.375,585.0938 L370,585.0938 L369.625,585.0938 L369,584.5781 L369,584.0938 L369,583.0938 L365,583.0938 L365,585.0938 L366,585.0938 L366,584.6094 L366,584.6094 L366.625,584.0938 L367,584.0938 L367.375,584.0938 L368,584.6094 L368,585.0938 L368,587.0938 L368,587.5781 L367.375,588.0938 L367.375,588.0938 L367,588.0938 L366.625,588.0938 L366,587.5781 L366,587.5781 L366,587.0938 L365,587.0938 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="68" x="395" y="583.457">«fsm-event»</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="97" x="380.5" y="598.5508">TrafficLightEvents</text><line style="stroke:#A80036;stroke-width:1.5;" x1="352.5" x2="479.5" y1="606.1875" y2="606.1875"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="27" x="357.5" y="621.6064">STOP</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="16" x="357.5" y="635.4424">GO</text><line style="stroke:#A80036;stroke-width:1.5;" x1="352.5" x2="479.5" y1="641.8594" y2="641.8594"/><!--MD5=[a261c3b0f6dc39c3323e9647de972898]
class TrafficLightContext--><rect codeLine="12" fill="#FEFECE" filter="url(#f15hjyl7xojn9a)" height="153.0391" id="TrafficLightContext" style="stroke:#A80036;stroke-width:1.5;" width="270" x="7" y="335"/><ellipse cx="86.75" cy="355.0938" fill="#B4A7E5" rx="11" ry="11" style="stroke:#A80036;stroke-width:1.0;"/><path d="M87.75,352.0938 L87.75,358.0938 L89.75,358.0938 L90.2344,358.0938 L90.75,358.7188 L90.75,359.0938 L90.75,359.4688 L90.2344,360.0938 L89.75,360.0938 L83.75,360.0938 L83.2656,360.0938 L82.75,359.4688 L82.75,359.0938 L82.75,358.7188 L83.2656,358.0938 L83.75,358.0938 L85.75,358.0938 L85.75,352.0938 L83.75,352.0938 L83.2656,352.0938 L82.75,351.4688 L82.75,351.0938 L82.75,350.7188 L83.2656,350.0938 L83.75,350.0938 L89.75,350.0938 L90.2344,350.0938 L90.75,350.7188 L90.75,351.0938 L90.75,351.4688 L90.2344,352.0938 L89.75,352.0938 L87.75,352.0938 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="77" x="119.75" y="352.457">«fsm-context»</text><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="102" x="107.25" y="367.5508">TrafficLightContext</text><line style="stroke:#A80036;stroke-width:1.5;" x1="8" x2="276" y1="375.1875" y2="375.1875"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="60" x="13" y="390.6064">name: String</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="97" x="13" y="404.4424">amberTimeout: Long</text><line style="stroke:#A80036;stroke-width:1.5;" x1="8" x2="276" y1="410.8594" y2="410.8594"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="120" x="13" y="426.2783">setStopped() «suspend»</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="174" x="13" y="440.1143">switchRed(on: Boolean) «suspend»</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="187" x="13" y="453.9502">switchAmber(on: Boolean) «suspend»</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="185" x="13" y="467.7861">switchGreen(on: Boolean) «suspend»</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="258" x="13" y="481.6221">stateChanged(toState: TrafficLightStates) «suspend»</text><!--MD5=[d85e1abf3caa9c226551ac440a773ac6]
class TrafficLightController--><rect codeLine="22" fill="#FEFECE" filter="url(#f15hjyl7xojn9a)" height="131.0156" id="TrafficLightController" style="stroke:#A80036;stroke-width:1.5;" width="189" x="50.5" y="66.5"/><ellipse cx="84.85" cy="82.5" fill="#B4A7E5" rx="11" ry="11" style="stroke:#A80036;stroke-width:1.0;"/><path d="M85.85,79.5 L85.85,85.5 L87.85,85.5 L88.3344,85.5 L88.85,86.125 L88.85,86.5 L88.85,86.875 L88.3344,87.5 L87.85,87.5 L81.85,87.5 L81.3656,87.5 L80.85,86.875 L80.85,86.5 L80.85,86.125 L81.3656,85.5 L81.85,85.5 L83.85,85.5 L83.85,79.5 L81.85,79.5 L81.3656,79.5 L80.85,78.875 L80.85,78.5 L80.85,78.125 L81.3656,77.5 L81.85,77.5 L87.85,77.5 L88.3344,77.5 L88.85,78.125 L88.85,78.5 L88.85,78.875 L88.3344,79.5 L87.85,79.5 L85.85,79.5 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="114" x="103.15" y="87.4102">TrafficLightController</text><line style="stroke:#A80036;stroke-width:1.5;" x1="51.5" x2="238.5" y1="98.5" y2="98.5"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="136" x="56.5" y="113.9189">amber: StateFlow&lt;Boolean&gt;</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="122" x="56.5" y="127.7549">red: StateFlow&lt;Boolean&gt;</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="134" x="56.5" y="141.5908">green: StateFlow&lt;Boolean&gt;</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="140" x="56.5" y="155.4268">stopped: SharedFlow&lt;Long&gt;</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="177" x="56.5" y="169.2627">state: StateFlow&lt;TrafficLightStates&gt;</text><line style="stroke:#A80036;stroke-width:1.5;" x1="51.5" x2="238.5" y1="175.6797" y2="175.6797"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="169" x="56.5" y="191.0986">changeAmberTimeout(value: Long)</text><!--MD5=[8f5d905706df63f012d7d74357fff60c]
class TrafficLightFSM--><rect codeLine="32" fill="#FEFECE" filter="url(#f15hjyl7xojn9a)" height="83.8594" id="TrafficLightFSM" style="stroke:#A80036;stroke-width:1.5;" width="118" x="357" y="369.5"/><ellipse cx="372.9" cy="389.5938" fill="#ADD1B2" rx="11" ry="11" style="stroke:#A80036;stroke-width:1.0;"/><path d="M374.9,386.0938 Q375.1031,385.5938 375.3375,385.3438 Q375.5719,385.0938 375.8375,385.0938 Q376.3063,385.0938 376.6031,385.375 Q376.9,385.6563 376.9,386.3125 L376.9,387.875 Q376.9,388.5313 376.6188,388.8125 Q376.3375,389.0938 375.9,389.0938 Q375.5094,389.0938 375.2594,388.9219 Q375.0094,388.75 374.9,388.2969 Q374.8531,387.9844 374.6813,387.8125 Q374.3688,387.4844 373.8063,387.2969 Q373.2438,387.0938 372.6813,387.0938 Q371.9781,387.0938 371.3844,387.375 Q370.8063,387.6563 370.3531,388.2813 Q369.9,388.9063 369.9,389.7656 L369.9,390.6875 Q369.9,391.7188 370.7438,392.4063 Q371.5875,393.0938 373.0875,393.0938 Q373.9781,393.0938 374.6031,392.8906 Q374.9625,392.7813 375.3688,392.4219 Q375.6344,392.2188 375.775,392.1563 Q375.9156,392.0938 376.0875,392.0938 Q376.4156,392.0938 376.65,392.3594 Q376.9,392.6094 376.9,392.9688 Q376.9,393.3125 376.5563,393.7188 Q376.0563,394.3125 375.2594,394.6406 Q374.2125,395.0938 372.9313,395.0938 Q371.4313,395.0938 370.2281,394.5 Q369.2594,394.0313 368.5719,393.0156 Q367.9,392 367.9,390.7969 L367.9,389.7031 Q367.9,388.4531 368.4938,387.3594 Q369.1031,386.2656 370.15,385.6875 Q371.2125,385.0938 372.4,385.0938 Q373.1188,385.0938 373.7438,385.3438 Q374.3688,385.5938 374.9,386.0938 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="34" x="412.1" y="386.957">«fsm»</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="84" x="387.1" y="402.0508">TrafficLightFSM</text><line style="stroke:#A80036;stroke-width:1.5;" x1="358" x2="474" y1="409.6875" y2="409.6875"/><line style="stroke:#A80036;stroke-width:1.5;" x1="358" x2="474" y1="417.6875" y2="417.6875"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="106" x="363" y="433.1064">fun start() «suspend»</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="105" x="363" y="446.9424">fun stop() «suspend»</text><!--MD5=[24d80c7a7824efcf0b8bd16fe5b50cae]
class TrafficLightService--><rect codeLine="41" fill="#FEFECE" filter="url(#f15hjyl7xojn9a)" height="249.8906" id="TrafficLightService" style="stroke:#A80036;stroke-width:1.5;" width="270" x="276" y="7"/><ellipse cx="337.25" cy="27.0938" fill="#ADD1B2" rx="11" ry="11" style="stroke:#A80036;stroke-width:1.0;"/><path d="M339.25,23.5938 Q339.4531,23.0938 339.6875,22.8438 Q339.9219,22.5938 340.1875,22.5938 Q340.6563,22.5938 340.9531,22.875 Q341.25,23.1563 341.25,23.8125 L341.25,25.375 Q341.25,26.0313 340.9688,26.3125 Q340.6875,26.5938 340.25,26.5938 Q339.8594,26.5938 339.6094,26.4219 Q339.3594,26.25 339.25,25.7969 Q339.2031,25.4844 339.0313,25.3125 Q338.7188,24.9844 338.1563,24.7969 Q337.5938,24.5938 337.0313,24.5938 Q336.3281,24.5938 335.7344,24.875 Q335.1563,25.1563 334.7031,25.7813 Q334.25,26.4063 334.25,27.2656 L334.25,28.1875 Q334.25,29.2188 335.0938,29.9063 Q335.9375,30.5938 337.4375,30.5938 Q338.3281,30.5938 338.9531,30.3906 Q339.3125,30.2813 339.7188,29.9219 Q339.9844,29.7188 340.125,29.6563 Q340.2656,29.5938 340.4375,29.5938 Q340.7656,29.5938 341,29.8594 Q341.25,30.1094 341.25,30.4688 Q341.25,30.8125 340.9063,31.2188 Q340.4063,31.8125 339.6094,32.1406 Q338.5625,32.5938 337.2813,32.5938 Q335.7813,32.5938 334.5781,32 Q333.6094,31.5313 332.9219,30.5156 Q332.25,29.5 332.25,28.2969 L332.25,27.2031 Q332.25,25.9531 332.8438,24.8594 Q333.4531,23.7656 334.5,23.1875 Q335.5625,22.5938 336.75,22.5938 Q337.4688,22.5938 338.0938,22.8438 Q338.7188,23.0938 339.25,23.5938 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="143" x="355.75" y="24.457">«context-implementation»</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="100" x="377.25" y="39.5508">TrafficLightService</text><line style="stroke:#A80036;stroke-width:1.5;" x1="277" x2="545" y1="47.1875" y2="47.1875"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="60" x="282" y="62.6064">name: String</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="97" x="282" y="76.4424">amberTimeout: Long</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="136" x="282" y="90.2783">amber: StateFlow&lt;Boolean&gt;</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="122" x="282" y="104.1143">red: StateFlow&lt;Boolean&gt;</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="134" x="282" y="117.9502">green: StateFlow&lt;Boolean&gt;</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="140" x="282" y="131.7861">stopped: SharedFlow&lt;Long&gt;</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="177" x="282" y="145.6221">state: StateFlow&lt;TrafficLightStates&gt;</text><line style="stroke:#A80036;stroke-width:1.5;" x1="277" x2="545" y1="152.0391" y2="152.0391"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="169" x="282" y="167.458">changeAmberTimeout(value: Long)</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="0" x="285" y="181.2939"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="120" x="282" y="195.1299">setStopped() «suspend»</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="174" x="282" y="208.9658">switchRed(on: Boolean) «suspend»</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="187" x="282" y="222.8018">switchAmber(on: Boolean) «suspend»</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="185" x="282" y="236.6377">switchGreen(on: Boolean) «suspend»</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="258" x="282" y="250.4736">stateChanged(toState: TrafficLightStates) «suspend»</text><!--MD5=[e90295f2306cf9f2d48d2dd155fc66d8]
link TrafficLightController to TrafficLightContext--><path codeLine="30" d="M144.3,197.711 C143.925,232.465 143.454,275.982 143.037,314.593 " fill="none" id="TrafficLightController-to-TrafficLightContext" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="none" points="150.034,314.932,142.818,334.855,136.034,314.781,150.034,314.932" style="stroke:#A80036;stroke-width:1.0;"/><!--MD5=[f5a4d25a21e2db1a9bef5b5bdfa80daf]
link TrafficLightFSM to TrafficLightStates--><path codeLine="37" d="M475.219,411.5 C498.139,411.5 524.525,411.5 548.273,411.5 " fill="none" id="TrafficLightFSM-to-TrafficLightStates" style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="#A80036" points="553.299,411.5,544.299,407.5,548.299,411.5,544.299,415.5,553.299,411.5" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="42" x="493.25" y="404.9951">«uses»</text><!--MD5=[ef55fa34c35daebc710b7e66915eb99f]
link TrafficLightFSM to TrafficLightEvents--><path codeLine="38" d="M416,453.748 C416,485.08 416,528.175 416,560.6872 " fill="none" id="TrafficLightFSM-to-TrafficLightEvents" style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="#A80036" points="416,565.811,420,556.811,416,560.811,412,556.811,416,565.811" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="42" x="417" y="532.4951">«uses»</text><!--MD5=[4f773506094c7b19ae20184ee571cf4e]
reverse link TrafficLightContext to TrafficLightFSM--><path codeLine="39" d="M282.627,411.5 C308.786,411.5 334.767,411.5 356.754,411.5 " fill="none" id="TrafficLightContext-backto-TrafficLightFSM" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="277.395,411.5,286.395,415.5,282.395,411.5,286.395,407.5,277.395,411.5" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="43" x="295.5" y="404.9951">context</text><!--MD5=[7e950ff0d6619f997f3686b3c3ce733c]
reverse link TrafficLightController to TrafficLightService--><path codeLine="58" d="M259.615,132 C264.983,132 270.351,132 275.719,132 " fill="none" id="TrafficLightController-backto-TrafficLightService" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="none" points="259.555,139,239.555,132,259.555,125,259.555,139" style="stroke:#A80036;stroke-width:1.0;"/><!--MD5=[b02eea57f08a8734f953d301797f548e]
link TrafficLightService to TrafficLightFSM--><path codeLine="59" d="M413.4533,269.1381 C413.4533,269.1381 414.578,331.552 415.024,356.331 " fill="none" id="TrafficLightService-TrafficLightFSM" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="415.261,369.461,419.0982,360.3904,415.1709,364.4618,411.0995,360.5345,415.261,369.461" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="415.1709" x2="415.0265" y1="364.4618" y2="356.463"/><polygon fill="#A80036" points="413.237,257.14,409.3458,263.2111,413.4533,269.1381,417.3445,263.0669,413.237,257.14" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="21" x="415" y="301.4951">fsm</text><!--MD5=[9b64a240cf38a4e55314ec445ba8fbf5]
@startuml

enum TrafficLightStates <<fsm-state>> {
    RED
    AMBER
    GREEN
}

enum TrafficLightEvents <<fsm-event>> {
    STOP
    GO
}
interface TrafficLightContext <<fsm-context>> {
    name: String
    amberTimeout: Long
    setStopped() <<suspend>>
    switchRed(on: Boolean) <<suspend>>
    switchAmber(on: Boolean) <<suspend>>
    switchGreen(on: Boolean) <<suspend>>
    stateChanged(toState: TrafficLightStates) <<suspend>>
}

interface TrafficLightController {
    amber: StateFlow<Boolean>
    red: StateFlow<Boolean>
    green: StateFlow<Boolean>
    stopped: SharedFlow<Long>
    state: StateFlow<TrafficLightStates>
    changeAmberTimeout(value: Long)
}
TrafficLightController -down-|> TrafficLightContext

class TrafficLightFSM <<fsm>> {
    fun start() <<suspend>>
    fun stop() <<suspend>>
}

TrafficLightFSM .right.> TrafficLightStates: <<uses>>
TrafficLightFSM .down.> TrafficLightEvents: <<uses>>
TrafficLightFSM -left-> TrafficLightContext: context

class TrafficLightService <<context-implementation>> {
    name: String
    amberTimeout: Long
    amber: StateFlow<Boolean>
    red: StateFlow<Boolean>
    green: StateFlow<Boolean>
    stopped: SharedFlow<Long>
    state: StateFlow<TrafficLightStates>
    changeAmberTimeout(value: Long)

    setStopped() <<suspend>>
    switchRed(on: Boolean) <<suspend>>
    switchAmber(on: Boolean) <<suspend>>
    switchGreen(on: Boolean) <<suspend>>
    stateChanged(toState: TrafficLightStates) <<suspend>>
}

TrafficLightService -left- -|> TrafficLightController
TrafficLightService *- -> TrafficLightFSM: fsm

@enduml

PlantUML version 1.2021.7(Sun May 23 14:40:07 CAT 2021)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: Cp1252
Language: en
Country: ZA
--></g></svg>